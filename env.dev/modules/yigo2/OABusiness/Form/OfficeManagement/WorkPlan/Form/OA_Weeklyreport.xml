<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Form Key="OA_weeklyreport" Caption="工作计划" FormType="Entity">
    <DataSource>
        <DataObject Key="OA_weeklyreport" Caption="OA_weeklyreport" PrimaryTableKey="OA_WeeklyReport" NoPrefix="OA" PrimaryType="Entity" ZeroPrefix="3">
            <TableCollection>
                <Table Key="OA_WeeklyReport" Caption="头表1">
                    <Column Key="OID" Caption="对象标识" DataType="Long"/>
                    <Column Key="SOID" Caption="主对象标识" DataType="Long"/>
                    <Column Key="POID" Caption="父对象标识" DataType="Long"/>
                    <Column Key="VERID" Caption="对象版本" DataType="Integer"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataType="Integer"/>
                    <Column Key="NO" Caption="单据编号" DataType="Varchar"/>
                    <Column Key="Status" Caption="单据状态" DataType="Integer"/>
                    <Column Key="BillDate" Caption="单据日期" DataType="DateTime"/>
                    <Column Key="Creator" Caption="制单人" DataType="Long" Description="保存人员" ItemKey="Operator"/>
                    <Column Key="CreateTime" Caption="制单日期" DataType="DateTime"/>
                    <Column Key="Modifier" Caption="修改人" DataType="Long"/>
                    <Column Key="ModifyTime" Caption="修改时间" DataType="DateTime"/>
                    <Column Key="InstanceID" Caption="流程实例" DataType="Long"/>
                    <Column Key="GroupID" Caption="GroupID" DataType="Long" AccessControl="true"/>
                    <Column Key="MapKey" Caption="映射标识" DataType="Varchar"/>
                    <Column Key="SrcOID" Caption="来源行标识" DataType="Long"/>
                    <Column Key="SrcSOID" Caption="来源表单标识" DataType="Long"/>
                    <Column Key="isPushed" Caption="已下推" DataType="Integer"/>
                    <Column Key="SourceBillID" Caption="源单ID" DataType="Long" Precision="16" Scale="2"/>
                    <Column Key="Week" Caption="工作周期" DataType="Long"/>
                    <Column Key="Migration" Caption="Migration" DataType="Varchar" Length="1000"/>
                    <Column Key="DateBegin" Caption="DateBegin" DataType="Date"/>
                    <Column Key="DateEnd" Caption="DateEnd" DataType="Date"/>
                </Table>
                <Table Key="OA_LWWork" Caption="上周工作完成情况" TableMode="Detail">
                    <Column Key="OID" Caption="对象标识" DataType="Long"/>
                    <Column Key="SOID" Caption="主对象标识" DataType="Long"/>
                    <Column Key="POID" Caption="父对象标识" DataType="Long"/>
                    <Column Key="VERID" Caption="对象版本" DataType="Integer"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataType="Integer"/>
                    <Column Key="MemberID" Caption="人员" DataType="Long"/>
                    <Column Key="Remark" Caption="备注" DataType="Varchar" Length="1000"/>
                    <Column Key="JobDescribe" Caption="工作内容描述" DataType="Varchar" Length="1000"/>
                    <Column Key="Completed" Caption="完成度" DataType="Long" Precision="16" Scale="2"/>
                    <Column Key="ActualCompleted" Caption="实际完成度" DataType="Long" Precision="16" Scale="2"/>
                    <Column Key="MapKey" Caption="映射标识" DataType="Varchar"/>
                    <Column Key="SrcOID" Caption="来源行标识" DataType="Long"/>
                    <Column Key="SrcSOID" Caption="来源表单标识" DataType="Long"/>
                    <Column Key="MapCount" Caption="映射数量标记" DataType="Integer"/>
                    <Column Key="WorkType" Caption="WorkType" DataType="Long"/>
                    <Column Key="WorkHours" Caption="WorkHours" DataType="Long" Precision="16" Scale="2"/>
                    <Column Key="ActualWorkHours" Caption="ActualWorkHours" DataType="Long" Precision="16" Scale="2"/>
                    <Column Key="HSourceID" Caption="HSourceID" DataType="Long"/>
                    <Column Key="DSourceID" Caption="DSourceID" DataType="Long"/>
                    <Column Key="PhaseCompleted" Caption="PhaseCompleted" DataType="Long" AccessControl="true"/>
                    <Column Key="ProjectPhases" Caption="ProjectPhases" DataType="Long" AccessControl="true"/>
                </Table>
                <Table Key="OA_TWWork" Caption="本周计划" TableMode="Detail">
                    <Column Key="OID" Caption="对象标识" DataType="Long"/>
                    <Column Key="SOID" Caption="主对象标识" DataType="Long"/>
                    <Column Key="POID" Caption="父对象标识" DataType="Long"/>
                    <Column Key="VERID" Caption="对象版本" DataType="Integer"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataType="Integer"/>
                    <Column Key="MemberID" Caption="人员" DataType="Long"/>
                    <Column Key="JobDescribe" Caption="工作内容描述" DataType="Varchar" Length="1000"/>
                    <Column Key="Completed" Caption="完成度" DataType="Long" Precision="16" Scale="2"/>
                    <Column Key="Remark" Caption="备注" DataType="Varchar" Length="1000"/>
                    <Column Key="MapKey" Caption="映射标识" DataType="Varchar"/>
                    <Column Key="SrcOID" Caption="来源行标识" DataType="Long"/>
                    <Column Key="SrcSOID" Caption="来源表单标识" DataType="Long"/>
                    <Column Key="MapCount" Caption="映射数量标记" DataType="Integer"/>
                    <Column Key="WorkType" Caption="WorkType" DataType="Long"/>
                    <Column Key="WorkHours" Caption="WorkHours" DataType="Long" Precision="16" Scale="2"/>
                    <Column Key="ProjectPhases" Caption="ProjectPhases" DataType="Long"/>
                    <Column Key="PhaseCompleted" Caption="PhaseCompleted" DataType="Long"/>
                </Table>
                <Table Key="OA_LWProblem" Caption="上周问题" TableMode="Detail" SourceType="Query" RefreshFilter="true">
                    <Column Key="OID" Caption="对象标识" DataType="Long"/>
                    <Column Key="SOID" Caption="主对象标识" DataType="Long"/>
                    <Column Key="POID" Caption="父对象标识" DataType="Long"/>
                    <Column Key="VERID" Caption="对象版本" DataType="Integer"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataType="Integer"/>
                    <Column Key="ProblemType" Caption="ProblemType" DataType="Long"/>
                    <Column Key="ProblemDesc" Caption="ProblemDesc" DataType="Varchar" Length="1000"/>
                    <Column Key="Answer" Caption="Answer" DataType="Varchar" Length="1000"/>
                    <TableFilter>
                        <![CDATA[SOID=?]]>
                    </TableFilter>
                    <ParameterCollection>
                        <Parameter Formula="OA_weeklyreport.SourceBillID"/>
                    </ParameterCollection>
                    <Statement>
                        <![CDATA[Select OID,SOID,POID,VerID,DverID,ProblemType,ProblemDesc,Answer From OA_TWProblem]]>
                    </Statement>
                </Table>
                <Table Key="OA_TWProblem" Caption="本周问题列表" TableMode="Detail">
                    <Column Key="OID" Caption="对象标识" DataType="Long"/>
                    <Column Key="SOID" Caption="主对象标识" DataType="Long"/>
                    <Column Key="POID" Caption="父对象标识" DataType="Long"/>
                    <Column Key="VERID" Caption="对象版本" DataType="Integer"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataType="Integer"/>
                    <Column Key="ProblemDesc" Caption="ProblemDesc" DataType="Varchar" Length="1000" Precision="16" Scale="2"/>
                    <Column Key="ProblemType" Caption="ProblemType" DataType="Long"/>
                    <Column Key="Answer" Caption="Answer" DataType="Varchar" Length="1000"/>
                </Table>
                <Table Key="OA_LWMember" Caption="上周人员情况" TableMode="Detail" SourceType="Query" GroupBy="H.SOID,D.MemberID">
                    <Column Key="OID" Caption="对象标识" DataType="Long"/>
                    <Column Key="SOID" Caption="主对象标识" DataType="Long"/>
                    <Column Key="POID" Caption="父对象标识" DataType="Long"/>
                    <Column Key="VERID" Caption="对象版本" DataType="Integer"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataType="Integer"/>
                    <Column Key="MemberID" Caption="MemberID" DataType="Long"/>
                    <Column Key="Saturation" Caption="Saturation" DataType="Numeric" Precision="16" Scale="2"/>
                    <Column Key="ActSaturation" Caption="ActSaturation" DataType="Numeric" Precision="16" Scale="2"/>
                    <TableFilter>
                        <![CDATA[H.SOID=?]]>
                    </TableFilter>
                    <ParameterCollection>
                        <Parameter Formula="GetOID()"/>
                    </ParameterCollection>
                    <Statement>
                        <![CDATA[Select H.OID,H.SOID,H.POID,H.VerID,H.DverID,D.MemberID,Case When isnull(W.WorkHours) Then 0 Else Sum(D.WorkHours)/W.WorkHours*100 End Saturation,Case When isnull(W.WorkHours) Then 0 Else Sum(D.ActualWorkHours)/W.WorkHours*100 End ActSaturation From OA_weeklyreport H Join OA_Week W On H.Week=W.SOID Join OA_LWWork D On H.SOID=D.SOID]]>
                    </Statement>
                </Table>
                <Table Key="OA_TWMember" Caption="本周人员情况" TableMode="Detail" SourceType="Query" GroupBy="H.SOID,D.MemberID">
                    <Column Key="OID" Caption="对象标识" DataType="Long"/>
                    <Column Key="SOID" Caption="主对象标识" DataType="Long"/>
                    <Column Key="POID" Caption="父对象标识" DataType="Long"/>
                    <Column Key="VERID" Caption="对象版本" DataType="Integer"/>
                    <Column Key="DVERID" Caption="对象明细版本" DataType="Integer"/>
                    <Column Key="MemberID" Caption="MemberID" DataType="Long"/>
                    <Column Key="Saturation" Caption="Saturation" DataType="Numeric" Precision="16" Scale="2"/>
                    <TableFilter>
                        <![CDATA[H.SOID=?]]>
                    </TableFilter>
                    <ParameterCollection>
                        <Parameter Formula="GetOID()"/>
                    </ParameterCollection>
                    <Statement>
                        <![CDATA[Select H.OID,H.SOID,H.POID,H.VerID,H.DverID,D.MemberID,Case When isnull(W.WorkHours) Then 0 Else Sum(D.WorkHours)/W.WorkHours*100 End Saturation From OA_weeklyreport H Join OA_Week W On H.Week=W.SOID Join OA_TWWork D On H.SOID=D.SOID]]>
                    </Statement>
                </Table>
            </TableCollection>
        </DataObject>
    </DataSource>
    <OperationCollection>
        <Operation Key="WORKITEM" Caption="WORKITEM" Tag="WORKITEM"/>
        <Operation Key="BPM" Caption="BPM" Tag="BPM"/>
        <Operation Key="Save" Caption="保存" Visible="!ReadOnly()">
            <Action>
                <![CDATA[UICheck();
var Nos = DBNamedQueryValue('conflictNOs', GroupID,GetOID(),Week);
if(Nos){
    RaiseErr("日期范围与单据 '"+Nos+"' 重复");
}
if(Status==1100){
    var rowno = 1;
    var allrow = "";
    loop 'TWProblem' (true) {
        if(IsControlNull('Answer2')){
            allrow=allrow+rowno+",";
        }
        rowno=rowno+1;
    }
    if(Length(allrow)>1){
        allrow=Left(allrow, Length(allrow)-1);
        RaiseErr("行号："+allrow+"[部门答复]不能为空")
    }
}
SaveData(); UpdateView();LoadData();
]]>
            </Action>
        </Operation>
        <Operation Key="Delete" Caption="删除" Visible="ReadOnly()&amp;&amp;Status==0">
            <Action>
                <![CDATA[DeleteData();UpdateView();Close();]]>
            </Action>
        </Operation>
        <Operation Key="Edit" Caption="编辑" Visible="ReadOnly()&amp;&amp;Status==0">
            <Action>
                <![CDATA[Edit();]]>
            </Action>
        </Operation>
        <Operation Key="ApproverEdit" Caption="填写部门答复" Visible="ReadOnly()&amp;&amp;Status==1100" Enable="GetOperator()==GetDictValue('OA_Group', OA_weeklyreport.GroupID, 'OA_Group.Approver')">
            <Action>
                <![CDATA[Edit();SetEnable('TWPlan', false);SetNewEmptyRow('TWPlan', false);SetEnable('TWSaturation', false);SetNewEmptyRow('TWSaturation', false);SetEnable('TWProblem', false);SetNewEmptyRow('TWProblem', false);SetEnable('GroupID', false)]]>
            </Action>
        </Operation>
        <Operation Key="Cancel" Caption="取消" Visible="!ReadOnly()">
            <Action>
                <![CDATA[Cancel();]]>
            </Action>
        </Operation>
        <Operation Key="Push" Caption="下推" Enable="ReadOnly()&amp;&amp;Status==1200&amp;&amp;isPushed==0" Visible="ReadOnly()&amp;&amp;Status==1200&amp;&amp;isPushed==0">
            <Action>
                <![CDATA[Map('OA_WorkCompleteness','OA_weeklyreport');]]>
            </Action>
        </Operation>
        <Operation Key="WFLogs" Caption="审批记录" RefKey="ShowWFLog"/>
    </OperationCollection>
    <ScriptCollection>
        <Script Key="Load" Caption="载入" Range="Action" Verb="Load">
            <![CDATA[LoadData();]]>
        </Script>
    </ScriptCollection>
    <QueryCollection>
        <Query Key="conflictNOs">
            <Statement>
                <![CDATA[Select No as billNOs From OA_weeklyreport
 Where GroupID=? and SOID<>ifnull(?,0) and  Week=?]]>
            </Statement>
            <ParameterCollection>
                <Parameter DataType="Long"/>
                <Parameter DataType="Long"/>
                <Parameter DataType="Long"/>
            </ParameterCollection>
        </Query>
    </QueryCollection>
    <UICheckRuleCollection>
        <UICheckRule Description="检查明细行" ErrorInfo="本周计划明细行必填一行">
            <![CDATA[GetRowCount("TWPlan", false)>=1]]>
        </UICheckRule>
    </UICheckRuleCollection>
    <Body>
        <Block>
            <FlexFlowLayoutPanel Key="root" Caption="根面板">
                <ToolBar Key="ToolBar1" Height="pref" Caption="ToolBar1">
                    <ToolBarItemCollection/>
                </ToolBar>
                <TabPanel Caption="TabPanel2" Height="100%" Key="TabPanel2">
                    <SplitPanel Key="main" Orientation="Vertical" Height="100%" Caption="基础信息">
                        <GridLayoutPanel Key="first_head" Height="pref" Padding="5px" Caption="问题描述">
                            <Format HAlign="Center" BackColor="#ffffff"/>
                            <Label Key="Lab_NO" Caption="单据编号" X="0" Y="0"/>
                            <TextEditor Key="NO" Caption="单据编号" BuddyKey="Lab_NO" X="1" Y="0" Enable="false">
                                <DataBinding TableKey="OA_WeeklyReport" ColumnKey="NO"/>
                                <Format HAlign="Left" BackColor="#f2f2f2"/>
                            </TextEditor>
                            <Label Key="Lab_Status" Caption="单据状态" X="2" Y="0"/>
                            <ComboBox Key="Status" Caption="单据状态" BuddyKey="Lab_Status" X="3" Y="0" SourceType="Status" Enable="false" IntegerValue="true">
                                <DataBinding TableKey="OA_WeeklyReport" ColumnKey="Status" DefaultValue="0"/>
                                <Format HAlign="Left"/>
                            </ComboBox>
                            <Dict Key="GroupID" Caption="工作小组" BuddyKey="Lab_GroupID" X="1" Y="1" ItemKey="OA_Group">
                                <DataBinding TableKey="OA_WeeklyReport" ColumnKey="GroupID" Required="true"/>
                                <Format HAlign="Left"/>
                            </Dict>
                            <Label Key="Lab_GroupID" Caption="工作小组" X="0" Y="1"/>
                            <DatePicker Key="DateBegin" Caption="工作日期" BuddyKey="Lab_DateBegin" X="1" Y="2" Enable="false" OnlyDate="true">
                                <DataBinding TableKey="OA_WeeklyReport" ColumnKey="DateBegin" DefaultFormulaValue="GetDictValue('OA_Week', Week, 'OA_Week.DateBegin')" ValueDependency="Week"/>
                                <Format HAlign="Left" BackColor="#f2f2f2"/>
                            </DatePicker>
                            <Label Key="Lab_DateBegin" Caption="工作日期" X="0" Y="2"/>
                            <DatePicker Key="DateEnd" Caption="到" BuddyKey="Lab_DateEnd" X="3" Y="2" Enable="false" OnlyDate="true">
                                <DataBinding TableKey="OA_WeeklyReport" ColumnKey="DateEnd" DefaultFormulaValue="GetDictValue('OA_Week', Week, 'OA_Week.DateEnd')"/>
                                <Format HAlign="Left" BackColor="#f2f2f2"/>
                            </DatePicker>
                            <Label Key="Lab_DateEnd" Caption="到" X="2" Y="2"/>
                            <CheckBox Caption="已完成" Enable="false" Key="isPushed" X="5" Y="0">
                                <DataBinding TableKey="OA_WeeklyReport" ColumnKey="isPushed"/>
                                <Format HAlign="Left"/>
                            </CheckBox>
                            <Dict Key="Week" Caption="工作周期" BuddyKey="Lab_Week" X="3" Y="1" Enable="!ReadOnly()&amp;&amp;Status==0" ItemKey="OA_Week">
                                <DataBinding TableKey="OA_WeeklyReport" ColumnKey="Week" Required="true">
                                    <ValueChanged>
                                        <![CDATA[DateBegin=GetDictValue('OA_Week', Week, 'OA_Week.DateBegin');
DateEnd=GetDictValue('OA_Week', Week, 'OA_Week.DateEnd');
WorkHours=GetDictValue('OA_Week', Week, 'OA_Week.WorkHours');]]>
                                    </ValueChanged>
                                </DataBinding>
                                <Format HAlign="Left"/>
                            </Dict>
                            <Label Key="Lab_Week" Caption="工作周期" X="2" Y="1"/>
                            <NumberEditor Key="WorkHours" Caption="工作小时数" BuddyKey="Lab_WorkHours" X="5" Y="2" Enable="false">
                                <DataBinding DefaultFormulaValue="GetDictValue('OA_Week', Week, 'OA_Week.WorkHours')"/>
                                <Format HAlign="Right" BackColor="#f2f2f2"/>
                            </NumberEditor>
                            <Label Key="Lab_WorkHours" Caption="工作小时数" X="4" Y="2"/>
                            <RowDefCollection RowGap="5" RowHeight="30">
                                <RowDef/>
                                <RowDef/>
                                <RowDef/>
                            </RowDefCollection>
                            <ColumnDefCollection ColumnGap="5">
                                <ColumnDef Width="80px" MinWidth="60px"/>
                                <ColumnDef Width="33%" MinWidth="60px"/>
                                <ColumnDef Width="80px" MinWidth="60px"/>
                                <ColumnDef Width="33%" MinWidth="60px"/>
                                <ColumnDef Width="80px" MinWidth="60px"/>
                                <ColumnDef Width="33%" MinWidth="60px"/>
                            </ColumnDefCollection>
                        </GridLayoutPanel>
                        <TabPanel Caption="本周计划" Key="TabPanel1">
                            <GridLayoutPanel Key="GridLayoutPanel1" Padding="5px" Caption="本周计划" LeftPadding="5px" RightPadding="5px">
                                <SplitPanel Key="SplitPanel1" Caption="SplitPanel1" X="0" Y="1">
                                    <Grid Key="TWPlan" Caption="本周计划">
                                        <GridColumnCollection>
                                            <GridColumn Key="MemberID2" Caption="人员" Width="80px"/>
                                            <GridColumn Key="WorkType2" Caption="工作分类" Width="80px"/>
                                            <GridColumn Key="JobDescribe2" Caption="工作内容描述" Width="240px"/>
                                            <GridColumn Key="Completed2" Caption="预计完成度(%)" Width="100px"/>
                                            <GridColumn Key="WorkHours2" Caption="预计工时(h)" Width="100px"/>
                                            <GridColumn Key="ProjectPhases1" Caption="项目阶段" Width="100px"/>
                                            <GridColumn Key="PhaseCompleted1" Caption="阶段完成度(%)" Width="100px"/>
                                            <GridColumn Key="Remark2" Caption="备注" Width="160px"/>
                                        </GridColumnCollection>
                                        <GridRowCollection>
                                            <GridRow Key="row1" RowHeight="35" TableKey="OA_TWWork">
                                                <GridCell Key="MemberID2" CellType="Dict" Caption="人员" Enable="!ReadOnly()&amp;&amp;Status==0" ItemKey="Operator">
                                                    <DataBinding ColumnKey="MemberID" Required="true"/>
                                                </GridCell>
                                                <GridCell Key="WorkType2" Caption="工作分类" CellType="Dict" ItemKey="OA_WorkType">
                                                    <DataBinding ColumnKey="WorkType"/>
                                                </GridCell>
                                                <GridCell Key="JobDescribe2" Caption="工作内容描述" CellType="TextEditor" Enable="!ReadOnly()&amp;&amp;Status==0" MaxLength="1000">
                                                    <DataBinding ColumnKey="JobDescribe" Required="true"/>
                                                </GridCell>
                                                <GridCell Key="Completed2" Caption="预计完成度(%)" CellType="NumberEditor" Enable="!ReadOnly()&amp;&amp;Status==0" IntegerValue="true">
                                                    <DataBinding ColumnKey="Completed" CheckRule="Completed2&lt;=100&amp;&amp;Completed2&gt;=0" ErrorInfo="预计完成度(%)要小于等于100并且大于等于0" Required="true"/>
                                                    <CellFormat HAlign="Right"/>
                                                </GridCell>
                                                <GridCell Key="WorkHours2" Caption="预计工时(h)" CellType="NumberEditor" IntegerValue="true">
                                                    <DataBinding ColumnKey="WorkHours" Required="true"/>
                                                    <CellFormat HAlign="Right"/>
                                                </GridCell>
                                                <GridCell Key="ProjectPhases1" Caption="项目阶段" CellType="Dict" Enable="!ReadOnly()&amp;&amp;Status==0" ItemKey="OA_ProjectPhases">
                                                    <DataBinding ColumnKey="ProjectPhases"/>
                                                </GridCell>
                                                <GridCell Key="PhaseCompleted1" Caption="阶段完成度(%)" CellType="NumberEditor" Enable="!ReadOnly()&amp;&amp;Status==0" IntegerValue="true" UseGroupingSeparator="false">
                                                    <DataBinding ColumnKey="PhaseCompleted" CheckRule="PhaseCompleted1&lt;=100&amp;&amp;PhaseCompleted1&gt;=0" ErrorInfo="[阶段完成度(%)]不能大于100且要大于等0"/>
                                                    <CellFormat HAlign="Right"/>
                                                </GridCell>
                                                <GridCell Key="Remark2" Caption="备注" CellType="TextEditor" Enable="!ReadOnly()&amp;&amp;Status==0" MaxLength="1000">
                                                    <DataBinding ColumnKey="Remark"/>
                                                </GridCell>
                                                <UICheckRuleCollection>
                                                    <UICheckRule Description="a" ErrorInfo="a">
                                                        <![CDATA[GetRowCount('TWPlan', false)>0]]>
                                                    </UICheckRule>
                                                </UICheckRuleCollection>
                                            </GridRow>
                                        </GridRowCollection>
                                    </Grid>
                                    <Grid Key="TWSaturation" Caption="本周人员饱和度" NewEmptyRow="false" CanDelete="false" CanInsert="false">
                                        <GridColumnCollection>
                                            <GridColumn Key="Member2" Caption="人员" Width="80px"/>
                                            <GridColumn Key="Saturation2" Caption="预计饱和度(%)" Width="80px"/>
                                        </GridColumnCollection>
                                        <GridRowCollection>
                                            <GridRow Key="row1" RowHeight="35" TableKey="OA_TWMember">
                                                <GridCell Key="Member2" Caption="人员" CellType="Dict" Enable="false" ItemKey="Operator">
                                                    <DataBinding ColumnKey="MemberID"/>
                                                </GridCell>
                                                <GridCell Key="Saturation2" Caption="预计饱和度(%)" CellType="NumberEditor" Enable="false">
                                                    <DataBinding ColumnKey="Saturation" CheckRule="Saturation2&gt;=0&amp;&amp;Saturation2&lt;=100" ErrorInfo="预计完成度(%)不得小于0且不得大于100"/>
                                                    <CellFormat HAlign="Right"/>
                                                </GridCell>
                                            </GridRow>
                                        </GridRowCollection>
                                    </Grid>
                                    <SplitSize Size="100%"/>
                                    <SplitSize Size="300px"/>
                                </SplitPanel>
                                <Label Key="Label_ThisWeek" Caption="本周计划" X="0" Y="0">
                                    <Format HAlign="Left">
                                        <Font Size="16" Bold="true"/>
                                    </Format>
                                </Label>
                                <RowDefCollection RowGap="5">
                                    <RowDef Height="30px"/>
                                    <RowDef Height="100%"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="5">
                                    <ColumnDef Width="100%"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                            <GridLayoutPanel Key="GridLayoutPanel2" Padding="5px" Caption="上周计划" LeftPadding="5px" RightPadding="5px">
                                <Label Key="Label_LastWeek" Caption="上周计划" X="0" Y="0">
                                    <Format HAlign="Left">
                                        <Font Size="16" Bold="true"/>
                                    </Format>
                                </Label>
                                <SplitPanel Key="SplitPanel2" Caption="SplitPanel2" X="0" Y="1">
                                    <Grid Key="LWPlan" Caption="上周完成情况">
                                        <GridColumnCollection>
                                            <GridColumn Key="HSourceID" Caption="源单ID" Width="80px" Visible="false"/>
                                            <GridColumn Key="DSourceID" Caption="源明细ID" Width="80px" Visible="false"/>
                                            <GridColumn Key="MemberID1" Caption="人员" Width="80px"/>
                                            <GridColumn Key="WorkType1" Caption="工作分类" Width="80px"/>
                                            <GridColumn Key="JobDescribe1" Caption="工作内容描述" Width="240px"/>
                                            <GridColumn Key="Completed" Caption="预计完成度(%)" Width="100px"/>
                                            <GridColumn Key="ActualCompleted" Caption="实际完成度(%)" Width="100px"/>
                                            <GridColumn Key="WorkHours1" Caption="预计工时(h)" Width="80px"/>
                                            <GridColumn Key="ActualWorkHours" Caption="实际工时(h)" Width="80px"/>
                                            <GridColumn Key="ProjectPhases2" Caption="项目阶段" Width="80px"/>
                                            <GridColumn Key="PhaseCompleted2" Caption="阶段完成度" Width="80px"/>
                                            <GridColumn Key="Remark1" Caption="备注" Width="160px"/>
                                        </GridColumnCollection>
                                        <GridRowCollection>
                                            <GridRow Key="row1" RowHeight="35" TableKey="OA_LWWork">
                                                <GridCell Key="HSourceID" Caption="源单ID" CellType="NumberEditor" IntegerValue="true">
                                                    <DataBinding ColumnKey="HSourceID"/>
                                                </GridCell>
                                                <GridCell Key="DSourceID" Caption="源明细ID" CellType="NumberEditor" IntegerValue="true">
                                                    <DataBinding ColumnKey="DSourceID"/>
                                                </GridCell>
                                                <GridCell Key="MemberID1" CellType="Dict" Caption="人员" Enable="!ReadOnly()&amp;&amp;HSourceID&lt;=0&amp;&amp;Status==0" ItemKey="Operator">
                                                    <DataBinding ColumnKey="MemberID"/>
                                                </GridCell>
                                                <GridCell Key="WorkType1" Caption="工作分类" CellType="Dict" Enable="!ReadOnly()&amp;&amp;HSourceID&lt;=0&amp;&amp;Status==0" ItemKey="OA_WorkType">
                                                    <DataBinding ColumnKey="WorkType"/>
                                                </GridCell>
                                                <GridCell Key="JobDescribe1" CellType="TextEditor" Caption="工作内容描述" Enable="!ReadOnly()&amp;&amp;HSourceID&lt;=0&amp;&amp;Status==0" MaxLength="1000">
                                                    <DataBinding ColumnKey="JobDescribe"/>
                                                </GridCell>
                                                <GridCell Key="Completed1" CellType="NumberEditor" Caption="预计完成度(%)" Enable="!ReadOnly()&amp;&amp;HSourceID&lt;=0&amp;&amp;Status==0" IntegerValue="true">
                                                    <DataBinding ColumnKey="Completed"/>
                                                    <CellFormat HAlign="Right"/>
                                                </GridCell>
                                                <GridCell Key="ActualCompleted" Caption="实际完成度(%)" CellType="NumberEditor" Enable="!ReadOnly()&amp;&amp;Status==0" IntegerValue="true">
                                                    <DataBinding ColumnKey="ActualCompleted" Required="true"/>
                                                    <CellFormat HAlign="Right"/>
                                                </GridCell>
                                                <GridCell Key="WorkHours1" Caption="预计工时(h)" CellType="NumberEditor" Enable="!ReadOnly()&amp;&amp;HSourceID&lt;=0&amp;&amp;Status==0" IntegerValue="true">
                                                    <DataBinding ColumnKey="WorkHours"/>
                                                    <CellFormat HAlign="Right"/>
                                                </GridCell>
                                                <GridCell Key="ActualWorkHours" Caption="实际工时(h)" CellType="NumberEditor" Enable="!ReadOnly()&amp;&amp;Status==0" IntegerValue="true">
                                                    <DataBinding ColumnKey="ActualWorkHours" Required="true"/>
                                                    <CellFormat HAlign="Right"/>
                                                </GridCell>
                                                <GridCell Key="ProjectPhases2" Caption="项目阶段" CellType="Dict" Enable="!ReadOnly()&amp;&amp;HSourceID&lt;=0&amp;&amp;Status==0" ItemKey="OA_ProjectPhases">
                                                    <DataBinding ColumnKey="ProjectPhases"/>
                                                </GridCell>
                                                <GridCell Key="PhaseCompleted2" Caption="阶段完成度" CellType="NumberEditor" Enable="!ReadOnly()&amp;&amp;HSourceID&lt;=0&amp;&amp;Status==0" IntegerValue="true">
                                                    <DataBinding ColumnKey="PhaseCompleted"/>
                                                </GridCell>
                                                <GridCell Key="Remark1" CellType="TextEditor" Caption="备注" Enable="!ReadOnly()&amp;&amp;Status==0" MaxLength="1000">
                                                    <DataBinding ColumnKey="Remark"/>
                                                </GridCell>
                                            </GridRow>
                                        </GridRowCollection>
                                    </Grid>
                                    <Grid Key="LastJobComplete" Caption="上周人员饱和度" NewEmptyRow="false" Height="50%" CanDelete="false" CanInsert="false" CanShift="false">
                                        <GridColumnCollection>
                                            <GridColumn Key="Member1" Caption="人员" Width="80px"/>
                                            <GridColumn Key="Saturation1" Caption="预计饱和度(%)" Width="80px"/>
                                            <GridColumn Key="ActSaturation1" Caption="实际饱和度(%)" Width="80px"/>
                                        </GridColumnCollection>
                                        <GridRowCollection>
                                            <GridRow Key="row1" RowHeight="35" TableKey="OA_LWMember">
                                                <GridCell Key="Member1" Caption="人员" CellType="Dict" Enable="false" ItemKey="Operator">
                                                    <DataBinding ColumnKey="MemberID"/>
                                                </GridCell>
                                                <GridCell Key="Saturation1" Caption="预计饱和度(%)" CellType="NumberEditor" Enable="false">
                                                    <DataBinding ColumnKey="Saturation"/>
                                                    <CellFormat HAlign="Right"/>
                                                </GridCell>
                                                <GridCell Key="ActSaturation1" Caption="实际饱和度(%)" CellType="NumberEditor" Enable="!ReadOnly()&amp;&amp;Status==0">
                                                    <DataBinding ColumnKey="ActSaturation"/>
                                                    <CellFormat HAlign="Right"/>
                                                </GridCell>
                                            </GridRow>
                                        </GridRowCollection>
                                    </Grid>
                                    <SplitSize Size="100%"/>
                                    <SplitSize Size="300px"/>
                                </SplitPanel>
                                <RowDefCollection RowGap="5">
                                    <RowDef Height="30px"/>
                                    <RowDef Height="100%"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="5">
                                    <ColumnDef Width="100%"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                            <GridLayoutPanel Key="Tab_Problem" Padding="5px" Caption="问题列表" LeftPadding="5px" RightPadding="5px">
                                <SplitPanel Key="SplitPanel4" Orientation="Vertical" Caption="SplitPanel4" X="0" Y="0">
                                    <GridLayoutPanel Key="Grid3" Caption="Grid3">
                                        <Label Key="Label_LWProblem" Caption="上周问题" X="0" Y="0">
                                            <Format HAlign="Left">
                                                <Font Size="16" Bold="true"/>
                                            </Format>
                                        </Label>
                                        <Grid Key="LWProblem" Caption="上周问题" NewEmptyRow="false" CanDelete="false" CanInsert="false" CanShift="false" X="0" Y="1">
                                            <GridColumnCollection>
                                                <GridColumn Key="ProblemType1" Caption="问题类型" Width="80px"/>
                                                <GridColumn Key="ProblemDesc1" Caption="问题描述" Width="360px"/>
                                                <GridColumn Key="Answer1" Caption="部门答复" Width="240px"/>
                                            </GridColumnCollection>
                                            <GridRowCollection>
                                                <GridRow Key="row1" RowHeight="35" TableKey="OA_LWProblem">
                                                    <GridCell Key="ProblemType1" Caption="问题类型" CellType="Dict" Enable="false" ItemKey="OA_ProblemType">
                                                        <DataBinding ColumnKey="ProblemType"/>
                                                    </GridCell>
                                                    <GridCell Key="ProblemDesc1" CellType="TextEditor" Caption="问题描述" Enable="false" MaxLength="1000">
                                                        <DataBinding ColumnKey="ProblemDesc"/>
                                                    </GridCell>
                                                    <GridCell Key="Answer1" CellType="TextEditor" Caption="部门答复" Enable="false" MaxLength="1000">
                                                        <DataBinding ColumnKey="Answer"/>
                                                    </GridCell>
                                                </GridRow>
                                            </GridRowCollection>
                                        </Grid>
                                        <RowDefCollection RowGap="5">
                                            <RowDef Height="30px"/>
                                            <RowDef Height="100%"/>
                                        </RowDefCollection>
                                        <ColumnDefCollection ColumnGap="5">
                                            <ColumnDef Width="100%"/>
                                        </ColumnDefCollection>
                                    </GridLayoutPanel>
                                    <GridLayoutPanel Key="Grid4" Caption="Grid4">
                                        <Grid Key="TWProblem" Caption="本周问题" X="0" Y="1">
                                            <GridColumnCollection>
                                                <GridColumn Key="ProblemType2" Caption="问题类型" Width="80px"/>
                                                <GridColumn Key="ProblemDesc2" Caption="问题描述" Width="360px"/>
                                                <GridColumn Key="Answer2" Caption="部门答复" Width="240px"/>
                                            </GridColumnCollection>
                                            <GridRowCollection>
                                                <GridRow Key="row1" RowHeight="35" TableKey="OA_TWProblem">
                                                    <GridCell Key="ProblemType2" Caption="问题类型" CellType="Dict" Enable="!ReadOnly()&amp;&amp;Status==0" ItemKey="OA_ProblemType">
                                                        <DataBinding ColumnKey="ProblemType"/>
                                                    </GridCell>
                                                    <GridCell Key="ProblemDesc2" Caption="问题描述" CellType="TextEditor" Enable="!ReadOnly()&amp;&amp;Status==0" MaxLength="1000">
                                                        <DataBinding ColumnKey="ProblemDesc"/>
                                                    </GridCell>
                                                    <GridCell Key="Answer2" Caption="部门答复" CellType="TextEditor" Enable="!ReadOnly()&amp;&amp;Status==1100" MaxLength="1000">
                                                        <DataBinding ColumnKey="Answer" CheckDependency="Answer2"/>
                                                    </GridCell>
                                                </GridRow>
                                            </GridRowCollection>
                                        </Grid>
                                        <Label Key="Label_TWProblem" Caption="本周问题" X="0" Y="0">
                                            <Format HAlign="Left">
                                                <Font Size="16" Bold="true"/>
                                            </Format>
                                        </Label>
                                        <RowDefCollection RowGap="5">
                                            <RowDef Height="30px"/>
                                            <RowDef Height="100%"/>
                                        </RowDefCollection>
                                        <ColumnDefCollection ColumnGap="5">
                                            <ColumnDef Width="100%"/>
                                        </ColumnDefCollection>
                                    </GridLayoutPanel>
                                    <SplitSize Size="50%"/>
                                    <SplitSize Size="50%"/>
                                </SplitPanel>
                                <RowDefCollection RowGap="5">
                                    <RowDef Height="100%"/>
                                </RowDefCollection>
                                <ColumnDefCollection ColumnGap="5">
                                    <ColumnDef Width="100%" MinWidth="100px"/>
                                </ColumnDefCollection>
                            </GridLayoutPanel>
                        </TabPanel>
                        <SplitSize Size="110px"/>
                        <SplitSize Size="100%"/>
                    </SplitPanel>
                    <GridLayoutPanel Key="Tab_SysInfo" Padding="5px" Caption="系统信息" LeftPadding="5px" RightPadding="5px">
                        <Label Key="Lab_BillDate" Caption="单据日期" X="2" Y="1"/>
                        <DatePicker Key="BillDate" Caption="单据日期" BuddyKey="Lab_BillDate" X="3" Y="1" Enable="false">
                            <DataBinding TableKey="OA_WeeklyReport" ColumnKey="BillDate"/>
                        </DatePicker>
                        <Dict Key="Creator" Caption="制单人" BuddyKey="Lab_Creator" X="1" Y="0" Enable="false" ItemKey="Operator">
                            <DataBinding TableKey="OA_WeeklyReport" ColumnKey="Creator"/>
                        </Dict>
                        <Label Key="Lab_Creator" Caption="制单人" X="0" Y="0"/>
                        <DatePicker Key="CreateTime" Caption="制单时间" BuddyKey="Lab_CreateTime" X="3" Y="0" Enable="false">
                            <DataBinding TableKey="OA_WeeklyReport" ColumnKey="CreateTime"/>
                        </DatePicker>
                        <Label Key="Lab_CreateTime" Caption="制单时间" X="2" Y="0"/>
                        <Dict Key="Modifier" Caption="修改人" BuddyKey="Lab_Modifier" X="5" Y="0" Enable="false" ItemKey="Operator">
                            <DataBinding TableKey="OA_WeeklyReport" ColumnKey="Modifier"/>
                        </Dict>
                        <Label Key="Lab_Modifier" Caption="修改人" X="4" Y="0"/>
                        <DatePicker Key="ModifyTime" Caption="修改时间" BuddyKey="Lab_ModifyTime" X="1" Y="1" Enable="false">
                            <DataBinding TableKey="OA_WeeklyReport" ColumnKey="ModifyTime"/>
                        </DatePicker>
                        <Label Key="Lab_ModifyTime" Caption="修改时间" X="0" Y="1"/>
                        <NumberEditor Key="SourceBillID" Caption="源单ID" BuddyKey="Lab_SourceBillID" X="5" Y="1" Enable="false" IntegerValue="true" UseGroupingSeparator="false">
                            <DataBinding TableKey="OA_WeeklyReport" ColumnKey="SourceBillID"/>
                        </NumberEditor>
                        <Label Key="Lab_SourceBillID" Caption="源单ID" X="4" Y="1"/>
                        <TextEditor Key="Migration" Caption="审批流迁移字段" BuddyKey="Lab_Migration" X="1" Y="2" Enable="false" MaxLength="1000">
                            <DataBinding TableKey="OA_WeeklyReport" ColumnKey="Migration"/>
                        </TextEditor>
                        <Label Key="Lab_Migration" Caption="审批流迁移字段" X="0" Y="2"/>
                        <RowDefCollection RowGap="5">
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                            <RowDef Height="30px"/>
                        </RowDefCollection>
                        <ColumnDefCollection ColumnGap="5">
                            <ColumnDef Width="80px" MinWidth="60px"/>
                            <ColumnDef Width="33%" MinWidth="60px"/>
                            <ColumnDef Width="80px" MinWidth="60px"/>
                            <ColumnDef Width="33%" MinWidth="60px"/>
                            <ColumnDef Width="80px" MinWidth="60px"/>
                            <ColumnDef Width="33%" MinWidth="60px"/>
                        </ColumnDefCollection>
                    </GridLayoutPanel>
                </TabPanel>
            </FlexFlowLayoutPanel>
        </Block>
    </Body>
</Form>
