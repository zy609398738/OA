jQuery.extend({createUploadIframe:function(d,b){var a="jUploadFrame"+d;if(window.ActiveXObject){if(jQuery.browser.version=="9.0"||jQuery.browser.version=="10.0"){var c=document.createElement("iframe");c.id=a;c.name=a}else{if(jQuery.browser.version=="6.0"||jQuery.browser.version=="7.0"||jQuery.browser.version=="8.0"){var c=document.createElement('<iframe id="'+a+'" name="'+a+'" />');if(typeof b=="boolean"){c.src="javascript:false"}else{if(typeof b=="string"){c.src=b}}}}}else{var c=document.createElement("iframe");c.id=a;c.name=a}c.style.position="absolute";c.style.top="-1000px";c.style.left="-1000px";document.body.appendChild(c);return c},createFormAndIFrame:function(a,f,e,l){var k="jUploadForm"+a;var c="jUploadFile"+a;var j="jUploadFrame"+a;var b=jQuery('<form  action="" method="POST" target="'+j+'"  name="'+k+'" id="'+k+'" enctype="multipart/form-data"></form>');if(e){e.isWeb=true}else{e={isWeb:true}}for(var d in e){jQuery('<input type="hidden" name="'+d+'" value="'+e[d]+'" />').appendTo(b)}var g=f;var h=l.newElement=$("<input type='file' name='file' data-url='upload'>");h.addClass(g.attr("class"));h[0].style.cssText=g[0].style.cssText;jQuery(g).attr("id",c);g.before(h);jQuery(g).appendTo(b);jQuery(b).css("position","absolute");jQuery(b).css("top","-1200px");jQuery(b).css("left","-1200px");jQuery(b).appendTo(document.body);return $("#"+k)},ajaxFileUpload:function(k){k=jQuery.extend({},jQuery.ajaxSettings,k);var a=new Date().getTime();var b=jQuery.createFormAndIFrame(a,k.fileElement,(typeof(k.data)=="undefined"?false:k.data),k);var f=jQuery.createUploadIframe(a,k.secureuri);var i="jUploadFrame"+a;var j="jUploadForm"+a;if(k.global&&!jQuery.active++){jQuery.event.trigger("ajaxStart")}var c=false;var g={};if(k.global){jQuery.event.trigger("ajaxSend",[g,k])}var d=function(l){var p=document.getElementById(i);try{if(p.contentWindow){g.responseText=p.contentWindow.document.body?p.contentWindow.document.body.innerHTML:null;g.responseXML=p.contentWindow.document.XMLDocument?p.contentWindow.document.XMLDocument:p.contentWindow.document}else{if(p.contentDocument){g.responseText=p.contentDocument.document.body?p.contentDocument.document.body.innerHTML:null;g.responseXML=p.contentDocument.document.XMLDocument?p.contentDocument.document.XMLDocument:p.contentDocument.document}}}catch(o){jQuery.handleError(k,g,null,o)}if(g||l=="timeout"){c=true;var m;try{m=l!="timeout"?"success":"error";if(m!="error"){var n=jQuery.uploadHttpData(g,k.dataType);if(k.success){k.success(n,m,k.newElement)}if(k.global){jQuery.event.trigger("ajaxSuccess",[g,k])}}else{jQuery.handleError(k,g,m)}}catch(o){m="error";jQuery.handleError(k,g,m,o)}if(k.global){jQuery.event.trigger("ajaxComplete",[g,k])}if(k.global&&!--jQuery.active){jQuery.event.trigger("ajaxStop")}if(k.complete){k.complete(g,m)}jQuery(p).unbind();setTimeout(function(){try{jQuery(p).remove();jQuery(b).remove()}catch(q){jQuery.handleError(k,g,null,q)}},100);g=null}};if(k.timeout>0){setTimeout(function(){if(!c){d("timeout")}},k.timeout)}try{var b=jQuery("#"+j);jQuery(b).attr("action",k.url);jQuery(b).attr("method","POST");jQuery(b).attr("target",i);if(b.encoding){jQuery(b).attr("encoding","multipart/form-data")}else{jQuery(b).attr("enctype","multipart/form-data")}jQuery(b).submit()}catch(h){jQuery.handleError(k,g,null,h)}jQuery("#"+i).load(d);return{abort:function(){}}},handleError:function(b,d,a,c){if(b.error){b.error.call(b.context||b,d,a,c)}if(b.global){(b.context?jQuery(b.context):jQuery.event).trigger("ajaxError",[d,b,c])}},uploadHttpData:function(r,type){var data=!type;data=type=="xml"||data?r.responseXML:r.responseText;if(type=="script"){jQuery.globalEval(data)}if(type=="json"){eval("data = "+data)}if(type=="html"){jQuery("<div>").html(data).evalScripts()}if(typeof type=="undefined"){data=$(data.firstChild).text()}return data}});