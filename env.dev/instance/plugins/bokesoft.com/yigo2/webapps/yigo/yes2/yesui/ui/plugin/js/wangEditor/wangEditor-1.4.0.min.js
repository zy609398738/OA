var BMap;var define;(function(a){if(typeof define==="function"){if(define.amd){define("wangEditor",["jquery"],a)}else{if(define.cmd){define(function(c,b,d){return a})}else{a(window.jQuery)}}}else{a(window.jQuery)}})(function(h){h(function(){var s=false,r=false,q=false,p;if(navigator.appName==="Microsoft Internet Explorer"){p=navigator.appVersion.split(";")[1].replace(/[ ]/g,"");s=p==="MSIE6.0";r=p==="MSIE7.0";q=p==="MSIE8.0"}if(s||r||q){window.onload=function(){function u(w,v){w.className="";w.innerHTML="<span style=\"font-family: 'icomoon'\">"+v+"</span>"}var t={"wangeditor-menu-img-link":"&#xe800;","wangeditor-menu-img-unlink":"&#xe801;","wangeditor-menu-img-code":"&#xe802;","wangeditor-menu-img-cancel":"&#xe803;","wangeditor-menu-img-terminal":"&#xe804;","wangeditor-menu-img-angle-down":"&#xe805;","wangeditor-menu-img-font":"&#xe806;","wangeditor-menu-img-bold":"&#xe807;","wangeditor-menu-img-italic":"&#xe808;","wangeditor-menu-img-header":"&#xe809;","wangeditor-menu-img-align-left":"&#xe80a;","wangeditor-menu-img-align-center":"&#xe80b;","wangeditor-menu-img-align-right":"&#xe80c;","wangeditor-menu-img-list-bullet":"&#xe80d;","wangeditor-menu-img-indent-left":"&#xe80e;","wangeditor-menu-img-indent-right":"&#xe80f;","wangeditor-menu-img-list-numbered":"&#xe810;","wangeditor-menu-img-underline":"&#xe811;","wangeditor-menu-img-table":"&#xe812;","wangeditor-menu-img-eraser":"&#xe813;","wangeditor-menu-img-text-height":"&#xe814;","wangeditor-menu-img-brush":"&#xe815;","wangeditor-menu-img-pencil":"&#xe816;","wangeditor-menu-img-minus":"&#xe817;","wangeditor-menu-img-picture":"&#xe818;","wangeditor-menu-img-file-image":"&#xe819;","wangeditor-menu-img-cw":"&#xe81a;","wangeditor-menu-img-ccw":"&#xe81b;","wangeditor-menu-img-music":"&#xe911;","wangeditor-menu-img-play":"&#xe912;","wangeditor-menu-img-location":"&#xe947;","wangeditor-menu-img-happy":"&#xe9df;","wangeditor-menu-img-sigma":"&#xea67","wangeditor-menu-img-enlarge2":"&#xe98b;","wangeditor-menu-img-shrink2":"&#xe98c;","wangeditor-menu-img-newspaper":"&#xe904;","wangeditor-menu-img-camera":"&#xe90f;","wangeditor-menu-img-video-camera":"&#xe914;","wangeditor-menu-img-file-zip":"&#xe92b;","wangeditor-menu-img-stack":"&#xe92e;","wangeditor-menu-img-credit-card":"&#xe93f;","wangeditor-menu-img-address-book":"&#xe944;","wangeditor-menu-img-envelop":"&#xe945;","wangeditor-menu-img-drawer":"&#xe95c;","wangeditor-menu-img-download":"&#xe960;","wangeditor-menu-img-upload":"&#xe961;","wangeditor-menu-img-lock":"&#xe98f;","wangeditor-menu-img-unlocked":"&#xe990;","wangeditor-menu-img-wrench":"&#xe991;","wangeditor-menu-img-eye":"&#xe9ce;","wangeditor-menu-img-eye-blocked":"&#xe9d1;","wangeditor-menu-img-command":"&#xea4e;","wangeditor-menu-img-font2":"&#xea5c;","wangeditor-menu-img-libreoffice":"&#xeade;","wangeditor-menu-img-quotes-left":"&#xe977;","wangeditor-menu-img-strikethrough":"&#xea65;","wangeditor-menu-img-desktop":"&#xf108;","wangeditor-menu-img-tablet":"&#xf10a;"};h(".wangEditor-container i").each(function(){var w=this,v=this.className,x=v.match(/wangeditor-menu-img-[^\s'"]+/);if(x){u(w,t[x[0]])}})}}});if(!h){alert("检测到页面没有引用jQuery，请先引用，否则wangEditor将无法使用。");return}else{if(typeof h!=="function"||/^\d+\.\d+\.\d+$/.test(h().jquery)===false){alert("检测到 window.jQuery 已被修改，wangEditor无法使用。");return}}var m=window.document,e=h(m),c=h(window),f=h("body"),n=window.location.hostname,l=n==="wangeditor.github.io"||n==="wangEditor.github.io",k=typeof m.createRange==="function",d=!!window.ActiveXObject||"ActiveXObject" in window,b=navigator.userAgent.indexOf("Firefox")>0,a="wangeditor_"+Math.random().toString().replace(".","")+"_",g=1,j=10,o=["<",">","(",")"],i=function(q,p){return new i.fn.init(q,p)};i.fn=i.prototype;h.extend(i,{consoleLog:function(p){if(window.console&&window.console.log&&typeof window.console.log==="function"){window.console.log("wangEditor提示：",p)}},getUniqeId:function(){return a+(g++)},filterXSSForUrl:function(q){var p=true;h.each(o,function(r,s){if(q.indexOf(s)>=0){p=false}});return p},replaceQuotes:function(q){if(q===""){return q}var p=q;p=p.replace(/(<.*?>)|(')|(")/mg,function(s,r,u,t){if(r){return r}else{if(u){return"&#39;"}else{if(t){return"&quot;"}}}});return p},showTableBorder:function(p){p.find("table").each(function(){var q=h(this),s="wangEditor_table_border_mark",r=q.attr(s);if(!r){q.attr("border","1");q.attr("bordercolor","#cccccc");q.attr("cellpadding","0");q.attr("cellspacing","0");q.css({"border-collapse":"collapse"});q.attr(s,"1")}})},addImgMaxWidth:function(p){p.find("img").each(function(){var q=h(this),s="wangEditor_img_max_width_mark",r=q.attr(s);if(!r){q.css("max-width","100%");q.attr(s,"1")}})}});h.extend(i,{styleConfig:{fontFamilyOptions:["宋体","黑体","楷体","隶书","幼圆","微软雅黑","Arial","Verdana","Georgia","Times New Roman","Microsoft JhengHei","Trebuchet MS","Courier New","Impact","Comic Sans MS"],colorOptions:{"#880000":"暗红色","#800080":"紫色","#ff0000":"红色","#ff00ff":"鲜粉色","#000080":"深蓝色","#0000ff":"蓝色","#00ffff":"湖蓝色","#008080":"蓝绿色","#008000":"绿色","#808000":"橄榄色","#00ff00":"浅绿色","#ffcc00":"橙黄色","#808080":"灰色","#c0c0c0":"银色","#000000":"黑色","#ffffff":"白色"},fontsizeOptions:{1:"10px",2:"13px",3:"16px",4:"19px",5:"22px",6:"25px",7:"28px"},blockQuoteStyle:"display:block; border-left: 5px solid #d0e5f2; padding:0 0 0 10px; margin:0; line-height:1.4; font-size: 100%;"},htmlTemplates:{elemDeleteBtn:'<a href="#" class="wangEditor-elemDeleteBtn"><i class="wangeditor-menu-img-cancel"></i></a>',imgResizeBtn:'<div class="wangEditor-imgResize"></div>',editorContainer:'<div class="wangEditor-container"></div>',btnContainer:'<div class="wangEditor-btn-container clearfix"></div>',btnContainerGroup:'<div class="wangEditor-btn-container-group"></div>',btn:'<a class="wangEditor-btn-container-btn wangEditor-btn-container-btn-default" href="#"></a>',btnAngleDown:'<i class="wangeditor-menu-img-angle-down" style="margin-left:3px;"></i>',tooltip:'<div class="wangEditor-toolTip"></div>',tooltipContent:'<div class="wangEditor-toolTip-content">{title}</div>',modalContainer:'<div class="wangEditor-modal-container"></div>',modal:'<div class="wangEditor-modal">{content}</div>',modalBig:'<div class="wangEditor-modal wangEditor-modal-big">{content}</div>',modalSmall:'<div class="wangEditor-modal wangEditor-modal-small">{content}</div>',modalMini:'<div class="wangEditor-modal wangEditor-modal-mini">{content}</div>',modalHeader:'<div class="wangEditor-modal-header clearfix"><a href="#" commandName="close" class="wangEditor-modal-header-close"><i class="wangeditor-menu-img-cancel"></i></a><b>{title}</b><div class="wangEditor-modal-header-line"></div></div>',txtContainer:'<div class="wangEditor-textarea-container"></div>',txt:'<div class="wangEditor-textarea" contenteditable="true"><p><br/></p></div>',dropMenu:'<ul class="wangEditor-drop-menu">{content}</ul>',dropPanel:'<div class="wangEditor-drop-panel">{content}</div>',dropPanelBig:'<div class="wangEditor-drop-panel wangEditor-drop-panel-big">{content}</div>',dropPanel_floatItem:'<div class="wangEditor-drop-panel-floatItem">{content}</div>',dropPanel_expression_tab_container:'<div class="clearfix wangEditor-expression-tab-container">{content}</div>',dropPanel_expression_tab:'<div index="{index}" class="wangEditor-expression-tab">{content}</div>',dropPanel_expression_group_container:'<div class="wangEditor-expression-group-container">{content}</div>',dropPanel_expression_group:'<div index="{index}" class="clearfix wangEditor-expression-group">{content}</div>',videoEmbed:['<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ','        codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0" ','        width="#{width}" ','        height="#{height}" >','   <param name="movie" ','          value="#{vedioUrl}" />','   <param name="allowFullScreen" value="true" />','   <param name="allowScriptAccess" value="always" />','   <param value="transparent" name="wmode" />','   <embed src="#{vedioUrl}"','          width="#{width}" ','          height="#{height}" ','          name="cc_8E6888CDEA7087C49C33DC5901307461" ','          allowFullScreen="true" ','          wmode="transparent" ','          allowScriptAccess="always" ','          pluginspage="http://www.macromedia.com/go/getflashplayer" ','          type="application/x-shockwave-flash"/>',"</object>","<p><br></p>"].join(""),videoH5:['<video src="#{vedioUrl}" controls="controls" width="#{width}" height="#{height}">',"</video>","<p><br></p>"].join(""),codePre:'<pre style="border:1px solid #ccc; background-color: #f5f5f5; padding: 10px; margin: 5px 0px; line-height: 1.4; font-size: 0.8em; font-family: Menlo, Monaco, Consolas; border-radius: 4px; -moz-border-radius: 4px; -webkit-border-radius: 4px;">{content}</pre><p><br></p>',codePreWidthHightLight:'<pre><code class="{lang}">{content}</code></pre><p><br></p>'},expressionConfig:{path:"http://wangeditor.github.io/expressions/",fileNames:[1,100],ext:".gif"},demoAlertConfig:{insertExpression:{title:"实际项目中，表情图标要配置到自己的服务器（速度快），也可配置多组表情，请查阅文档。\n\n\n【该弹出框在实际项目中不会出现】",isAlert:false},insertImage:{title:"实际项目中，可查阅配置文件，如何配置上传本地图片（支持跨域）\n\n\n【该弹出框在实际项目中不会出现】",isAlert:false},insertCode:{title:"实际项目中，可配置高亮代码，请查阅文档\n\n\n【该弹出框在实际项目中不会出现】",isAlert:false}}});h.extend(i,{getUploadImgComponentForCrossDomain:function(s){var q=s.uploadUrl,B="wangEditor_uploadImg",w="|.bmp|.jpg|.jpeg|.png|.gif|";var I=i.getUniqeId(),H=i.getUniqeId(),v=i.getUniqeId(),u=i.getUniqeId(),p=i.getUniqeId(),z=i.getUniqeId();var y=s.langConfig,K=y.menus.insertImage,J=K.modal,D=J.choose,r=J.title,t=K.alert,E=t.chooseAImage,F=t.fileTypeError,A=t.uploading,x=y.common.upload;var C='<form id="'+I+'" method="post" enctype="multipart/form-data" target="'+z+'">   <p>'+D+'：<input type="file" accept="image/*" name="'+B+'" id="'+H+'"/></p>   <p>'+r+'：<input type="text" id="'+v+'" style="width:250px;"/></p>   <p><button id="'+u+'"  type="button" class="wangEditor-modal-btn">'+x+'</button></p>   <span stype="color:red;" id="'+p+'"></span></form><div style="display:none;"><iframe id="'+z+'" name="'+z+'" style="display:none; width:0; height:0;"></iframe></div>',G=h(C);G.find("#"+u).click(function(P){if(q==null||typeof q!=="string"){alert("未配置URL地址，不能上传图片");return}var L=h("#"+H).val();if(L===""){alert(E);return}var N=L.slice(L.lastIndexOf(".")-L.length);N="|"+N.toLowerCase()+"|";if(w.indexOf(N)===-1){alert(F);return}var S=h(this),M=h("#"+p),U=h("#"+I),R=h("#"+v).val(),O=m.getElementById(z),T=function(){h("#"+H).val("");h("#"+v).val("")};window.wangEditor_uploadImgCallback=function(W){i.consoleLog("父页面的wangEditor_uploadImgCallback方法已经开始被调用！");var V,X,Y;if(W.indexOf("ok|")===0){V=W.split("|");X=V[1];i.consoleLog("wangEditor_uploadImgCallback方法成功获取到图片url："+X);if(V.length===2){if(R===""){s.command(P,"insertImage",X,T)}else{s.command(P,"customeInsertImage",{url:X,title:R},T)}}else{if(V.length===3){Y=V[2];i.consoleLog("wangEditor_uploadImgCallback方法成功获取到缩略图url："+Y);s.command(P,"customeInsertImage",{url:Y,link:X,title:R},T)}else{alert("hash格式错误："+W);return}}i.consoleLog("wangEditor_uploadImgCallback方法已经成功插入图片，弹出框也被关闭！")}else{alert(W)}window.wangEditor_uploadImgCallback=undefined};S.hide();M.html(A);try{U.attr("action",q);U.submit()}catch(Q){alert(Q.name+":"+Q.message)}finally{S.show();M.html("");P.preventDefault()}return false});return G}});h.extend(i,{langs:{}});h.extend(i.langs,{zhs:{common:{insert:"插入",submit:"提交",update:"更新",cancel:"取消",close:"关闭",upload:"上传",unsafeAlert:"输入的内容不安全，请重新输入！",formatError:"输入的内容格式错误，请重新输入！"},menus:{viewSourceCode:{title:"查看源码"},bold:{title:"加粗"},underline:{title:"下划线"},italic:{title:"斜体"},removeFormat:{title:"清除格式"},indent:{title:"增加缩进"},outdent:{title:"减少缩进"},foreColor:{title:"字体颜色"},backgroundColor:{title:"背景色"},strikethrough:{title:"删除线"},blockquote:{title:"引用"},fontFamily:{title:"字体"},fontSize:{title:"字号"},setHead:{title:"标题",content:"正文"},list:{title:"列表",unOrdered:{title:"无序列表"},ordered:{title:"有序列表"}},justify:{title:"对齐",left:{title:"左对齐"},center:{title:"居中"},right:{title:"右对齐"}},createLink:{title:"插入链接",modal:{link:"链接",title:"标题",blank:"新窗口"}},unLink:{title:"取消链接"},insertTable:{title:"插入表格",modal:{rowNum:"行数",colNum:"列数",showFirstRow:"显示首行"}},insertHr:{title:"横线"},insertExpression:{title:"表情"},insertImage:{title:"图片",modal:{insertWeb:"插入网络图片",insertLocal:"上传本地图片",url:"网址",title:"标题",choose:"选择"},alert:{chooseAImage:"请选择图片文件",fileTypeError:"选择的文件不是图片格式",uploading:"上传中..."}},insertVideo:{title:"视频",modal:{url:"地址",width:"宽度",height:"高度"}},insertLocation:{title:"位置",modal:{city:"城市",location:"位置",search:"搜索",clear:"清除标记",loading:"地图加载中...",dynamic:"动态地图"},alert:{cantFindLocation:"没有找到您输入的地址",dynamicOneLocation:"动态地图只能显示一个位置"}},insertCode:{title:"插入代码",modal:{title:"请输入代码 "}},undo:{title:"撤销"},redo:{title:"重复"},fullScreen:{title:"全屏"},mobilePreView:{title:"手机预览"}}}});h.extend(i.langs,{en:{common:{insert:"insert",submit:"submit",update:"update",cancel:"cancel",close:"close",upload:"upload",unsafeAlert:"Unsafe content, please input again!",formatError:"Format error, please input again!"},menus:{viewSourceCode:{title:"source code"},bold:{title:"bold"},underline:{title:"under line"},italic:{title:"italic"},removeFormat:{title:"remove format"},indent:{title:"indent"},outdent:{title:"outdent"},foreColor:{title:"font color"},backgroundColor:{title:"background Color"},strikethrough:{title:"delete line"},blockquote:{title:"quote"},fontFamily:{title:"font family"},fontSize:{title:"font size"},setHead:{title:"head",content:"content"},list:{title:"list",unOrdered:{title:"unOrdered"},ordered:{title:"ordered"}},justify:{title:"justify",left:{title:"left"},center:{title:"center"},right:{title:"right"}},createLink:{title:"create link",modal:{link:"link",title:"title",blank:"blank"}},unLink:{title:"unlink"},insertTable:{title:"table",modal:{rowNum:"rows",colNum:"columns",showFirstRow:"show first row"}},insertHr:{title:"hr"},insertExpression:{title:"expressions"},insertImage:{title:"image",modal:{insertWeb:"inset web image",insertLocal:"upload local image",url:"url",title:"title",choose:"choose"},alert:{chooseAImage:"Choose a image file please!",fileTypeError:"Selected file is not a picture format!",uploading:"uploading..."}},insertVideo:{title:"video",modal:{url:"url",width:"width",height:"height"}},insertLocation:{title:"location",modal:{city:"city",location:"location",search:"search",clear:"clear locations",loading:"map loading...",dynamic:"dynamic map"},alert:{cantFindLocation:"Can not find location which you input",dynamicOneLocation:"Keep only one location in dynamic map"}},insertCode:{title:"insert code",modal:{title:"insert code here "}},undo:{title:"undo"},redo:{title:"redo"},fullScreen:{title:"full screen"},mobilePreView:{title:"mobile preview"}}}});h.extend(i,{commandEnabled:function(r){var p;try{p=m.queryCommandEnabled(r)}catch(q){p=false}return p},getElemForInsertTable:function(p){if(p[0].nodeName.toLowerCase()==="body"){return}if(p.parent().is('div[contenteditable="true"]')){return p}if(p.is('div[contenteditable="true"]')){if(p.children().length===0){p.append(h("<p></p>"))}return p.children().last()}else{return this.getElemForInsertTable(p.parent())}}});h.extend(i,{createMenuGroup:function(r,q){if(r instanceof Array===false){return}var p=h(i.htmlTemplates.btnContainerGroup);h.each(r,function(t,u){var s=i.createMenu(u,q);if(s instanceof Array){h.each(s,function(v,w){p.append(w)})}else{p.append(s)}});q.insertMenuGroup(p)},createMenu:function(q,v){if(q==null){return}q=h.trim(q.toString());var x=v.menus[q];if(!x){return}var S=x.title,t=x.type,C=x.cssClass,G,N=x.style,u=x.command,z=x.commandValue,M=x.hotKey,r=[],A,w=x.beforeFn,R=x.dropMenu&&x.dropMenu(),I=x.dropPanel&&x.dropPanel(v),D=x.modal&&x.modal(v),y=x.callback,K=h(i.htmlTemplates.btn),L=[K],B,J,s,H,F,O=v.$editorContainer;if(typeof u==="string"){u=h.trim(u)}if(N){G='<i class="'+C+'" style="'+N+'"></i>'}else{G='<i class="'+C+'"></i>'}K.html(G);if(S){K.attr("title",S)}if(t==="btn"){if(typeof u==="string"){K.attr("commandName",u)}if(typeof u==="string"){B=function(T){v.hideModal();v.command(T,u,z,y);T.stopPropagation()}}if(typeof u==="function"){B=function(T){v.hideModal();u(T);T.stopPropagation()}}if(M){M=M.toLowerCase();A=h.trim(M.split("+")[1]);r=M.split("+")[0].split(",");h.each(r,function(T,U){r[T]=h.trim(U)});J=function(U){var T=true;h.each(["ctrl","shift","alt","meta"],function(V,W){if(r.indexOf(W)!==-1&&!U[W+"Key"]){T=false}else{if(r.indexOf(W)===-1&&U[W+"Key"]){T=false}}});return T};v.bindEventFor$txt("keydown",function(T){if(J(T)===false){return}if(String.fromCharCode(T.keyCode).toLowerCase()===A){T.preventDefault();K.click()}})}}else{if(t==="dropMenu"){K.append(h(i.htmlTemplates.btnAngleDown));L.unshift(R);s=function(){R.hide()};B=function(T){v.hideModal();R.css("display","inline-block");T.preventDefault();K.focus();T.stopPropagation()};K.blur(function(T){setTimeout(s,200)});R.on("click","a[commandValue], a[customCommandName]",function(W){var V=h(this),U=V.attr("commandValue"),T=V.attr("customCommandName");if(T){u=T}v.command(W,u,U,y)});s()}else{if(t==="dropPanel"){L.unshift(I);H=function(){I.hide()};B=function(X){v.hideModal();I.css("display","inline-block");var T=O.offset().left,V=O.outerWidth(),U=I.offset().left,Y=I.outerWidth(),W=(U+Y)-(T+V);if(W>0){I.css("margin-left",0-W)}X.preventDefault();K.focus();X.stopPropagation()};I.on("click","a[commandValue]",function(V){var U=h(this),T=U.attr("commandValue");v.command(V,u,T,y)});H()}else{if(t==="modal"){D.prepend(h(i.htmlTemplates.modalHeader.replace("{title}",S)));v.insertModal(D);B=function(W){v.hideModal();D.show();var V=v.$editorContainer.outerWidth(),U=D.outerWidth(),T=v.$editorContainer.offset().left,Z=D.offset().left;D.css("margin-left",(T-Z)+(V/2-U/2));var Y=v.$txtContainer.offset().top,X=D.offset().top;D.css("margin-top",Y-X+5);W.preventDefault();W.stopPropagation()};D.find("[commandName=close]").click(function(T){D.css({"margin-left":0,"margin-top":0}).hide();T.preventDefault()})}}}}K.click(function(U){var T=i.demoAlertConfig;if(w&&typeof w==="function"){w(v)}if(B&&typeof B==="function"){if(l){if(T[q]){if(T[q].isAlert===false){alert(T[q].title);T[q].isAlert=true}}}B(U)}});if(S){K.attr("title","");var p=h(i.htmlTemplates.tooltip),P=h(i.htmlTemplates.tooltipContent.replace("{title}",S)),E,Q;p.append(P);L.unshift(p);F=function(){p.css("display","inline-block")};K.mouseenter(function(){if(!Q){Q=p.css("margin-left")}if(Q==="0px"){Q=(0-(p.outerWidth()/2-K.outerWidth()/2))+"px";p.css("margin-left",Q)}E=setTimeout(F,200)}).mouseleave(function(){clearTimeout(E);p.hide()})}return L}});h.extend(i.fn,{init:function(u,E){var s=E.onchange,x=E.menuConfig,w=E.expressions,A=E.uploadImgComponent,z=E.uploadUrl,v=E.pasteUrl,q=E.lang,r=E.filterJs,y=this,C=u.height(),B=u.css("max-height"),t=h.trim(u.val());var p=u.attr("id");if(!p){p=i.getUniqeId()}y.id=p;y.$editorContainer=h(i.htmlTemplates.editorContainer);y.$btnContainer=h(i.htmlTemplates.btnContainer);y.$modalContainer=h(i.htmlTemplates.modalContainer);y.$txtContainer=h(i.htmlTemplates.txtContainer);y.$txt=h(i.htmlTemplates.txt);y.$textarea=u;y.$elemDeleteBtn=h(i.htmlTemplates.elemDeleteBtn);y.$imgResizeBtn=h(i.htmlTemplates.imgResizeBtn);y.$txtContainer.append(y.$txt);y.$editorContainer.append(y.$btnContainer).append(y.$txtContainer).append(y.$elemDeleteBtn).append(y.$imgResizeBtn);h("body").append(y.$modalContainer);if(C<=80){C=80}if(parseInt(B)<=C||!B){B="none"}h(function(){var F=C-y.$btnContainer.outerHeight();F=F-2;if(F<=0){F=C-32}if(typeof B==="string"&&B!=="none"){y.$txtContainer.css("max-height",B)}else{y.$txtContainer.height(F)}y.$txt.css("min-height",(F-10)+"px")});if(u.prop("readonly")){y.$txt.attr("contenteditable",false)}if(s&&typeof s==="function"){y.onchange=s}if(w&&w.length&&w.length>0){y.expressions=w}y.initLang(q);if(r==null){r=true}y.filterJs=r;if(z&&typeof z==="string"){y.uploadUrl=z;y.uploadImgComponent=i.getUploadImgComponentForCrossDomain(y)}if(A){y.uploadImgComponent=A}y.initMenus();y.initMenuConfig();if(x&&(x instanceof Array)===true&&(x[0] instanceof Array)===true){y.editorMenuConfig=x}y.menuGroupLength=0;h.each(y.editorMenuConfig,function(F,G){i.createMenuGroup(G,y)});if(y.menuGroupLength===1){y.$btnContainer.children().first().css("border-right","0")}function D(F){y.saveSelection();y.updateMenuStyle();if(F&&F.type==="focus"){y.$txt.off("focus",D)}}y.$txt.on("focus",D).on("mousedown",function(){y.$txt.on("mouseleave",function(){y.$txt.off("mouseleave");setTimeout(D,100)})}).on("click keyup",function(H){y.$txtContainer.addClass("wangEditor-textarea-focus");var G=false,F=[33,34,35,36,37,38,39,40,13,8,46,9,65];G=(H.type==="click"||(H.type==="keyup"&&(F.indexOf(H.keyCode)!==-1)||H.ctrlKey||H.shiftKey||H.metaKey));if(!G){return}D();if(H.type==="click"){y.$txt.off("mouseleave")}}).on("focus blur",function(){y.$txtContainer.removeClass("wangEditor-textarea-focus");y.addCommandRecord()}).on("keyup",function(G){var F=G.keyCode;if(G.keyCode===13){y.addCommandRecord()}}).on("keydown",function(G){G.stopPropagation();if(G.keyCode===9){y.command(G,"insertHTML","&nbsp;&nbsp;&nbsp;&nbsp;")}var F;if(G.keyCode===8){F=y.$txt.html();if(/^<(\w+)[^<>]*><br><\/\1>$/.test(F)){G.preventDefault()}}});if(d||b){y.initDeleteBtn("table")}else{y.initDeleteBtn("img,table")}if(!d&&!b){y.initImgResizeBtn("img")}y.initLang(q);y.bindPaste(v);y.$txtContainer.click(function(){y.hideModal()});y.$btnContainer.click(function(){y.hideModal()});y._initCommandRecord();y.latestHtml=y.html();y.$txt.blur(function(){y.change()});if(t){y.$txt.html(t);y.change()}y.$txt.focus();return y}});h.extend(i.fn,{insertMenuGroup:function(p){this.$btnContainer.append(p);this.menuGroupLength+=1},insertModal:function(p){this.$modalContainer.append(p)},"bindEventFor$txt":function(q,p){this.$txt.on(q,p)},html:function(p){if(p==null){return this.$txt.html()}else{if(typeof p==="string"){this.$txt.html(p);this.change()}}},text:function(){return this.$txt.text()},append:function(p){if(p==null){return}if(typeof p==="string"){p="<div>"+p+"</div>";this.$txt.append(h(p))}if(p instanceof h){this.$txt.append(p)}this.change()},textareaVal:function(p){if(p||p===""){this.$textarea.val(p)}else{return this.$textarea.val()}},hideModal:function(){this.$modalContainer.find(".wangEditor-modal:visible").css({"margin-top":0,"margin-left":0}).hide();this.$btnContainer.find(".wangEditor-drop-panel:visible").hide();this.$btnContainer.find(".wangEditor-drop-menu:visible").hide()},getEditorContainer:function(){return this.$editorContainer},blur:function(){this.$txt.blur()},focus:function(){this.$txt.focus()},hide:function(){this.$editorContainer.hide()},show:function(){this.$editorContainer.show()}});h.extend(i.fn,{initDeleteBtn:function(p){var r=this,q=r.$elemDeleteBtn,t;function s(){var u=q.css("display");if(u!==""&&u!=="none"){q.hide()}t=""}r.$txt.on("click",p,function(B){var u=h(this),y=u.data("deleteBtnId"),C=i.getUniqeId();if(y&&t===y){B.stopPropagation();return}else{if(!y){u.data("deleteBtnId",C);y=C}t=y}var z=r.$btnContainer.position().top,x=r.$btnContainer.outerHeight(),D=u.position(),A=D.top,w=D.left,E=q.width(),v=q.height();if(A<=z+x){return}q.css({top:(A-v/2)+"px",left:(w-E/2)+"px"});q.show();r.$txtContainer.off("scroll.deleteBtn");r.$txtContainer.on("scroll.deleteBtn",s);q.off();q.click(function(F){r.command(F,"delete$elem",u,s)});B.stopPropagation();B.preventDefault()});r.$txt.on("click keyup",function(u){s()})}});h.extend(i.fn,{initImgResizeBtn:function(r){var t=this,q=t.$imgResizeBtn,u,p=false;function s(){if(p){return}var v=q.css("display");if(v!==""&&v!=="none"){q.hide()}u=""}t.$txt.on("click",r,function(N){var x=h(this),w=x.data("imgResizeId"),B=i.getUniqeId();if(w&&u===w){N.stopPropagation();return}else{if(!w){x.data("imgResizeId",B);w=B}u=w}var z=x.position(),y=z.top,v=z.left,M=x.outerWidth(),I=x.outerHeight(),Q=t.$txtContainer.position(),G=Q.top,O=Q.left,D=t.$txtContainer.outerWidth(),F=t.$txtContainer.outerHeight(),A=q.outerWidth(),R=q.outerHeight(),E=t.$editorContainer.position(),L=E.left,H=E.top,P,C,K,J;if(y+I>G+F){return}if(v+M>O+D){return}q.css({top:(y+I-R)+"px",left:(v+M-A)+"px"});q.show();t.$txtContainer.off("scroll.resizebtn");t.$txtContainer.on("scroll.resizebtn",s);q.off();q.on("mousedown",function(S){p=true;var T=q.position();K=S.pageX-L-T.left;J=S.pageY-H-T.top;P=q.outerWidth();C=q.outerHeight()});e.off("mousemove.resizeBtn mouseup.resizeBtn");e.on("mousemove.resizeBtn",function(U){if(p){var S=U.pageX-L-K,X=U.pageY-H-J;q.css({top:X,left:S});var W=q.position(),T=W.left,V=W.top;x.css({width:T+P-v,height:V+C-y});U.preventDefault()}}).on("mouseup.resizeBtn",function(S){p=false});N.stopPropagation();N.preventDefault()});t.$txt.on("click keyup blur",function(v){if(v.type==="blur"){setTimeout(s,100)}else{s()}})}});h.extend(i.fn,{initLang:function(t){var q=this,r=i.langs,p="zhs",s=r[p];if(typeof t==="object"){if(t===null){t={}}h.extend(true,s,t)}else{if(typeof t==="string"){if(t in r){s=r[t]}else{t=p}}else{t=p}}q.defaultLang=p;q.lang=t;q.langConfig=s}});h.extend(i.fn,{bindPaste:function(r){var u=this,p=u.$txt,t=Date.now();function q(){if(Date.now()-t<100){return false}else{t=Date.now();return true}}p.on("paste",function(w){var v=w.clipboardData||w.originalEvent.clipboardData;var x;if(v==null||v.getData==null){return}x=v.getData("text");if(x===""){return}if(!q()){return}x=x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&#39;").replace(/\"/g,"&quot;").replace(/\n/g,"<br>");u.command(w,"insertHTML",x);w.preventDefault()});function s(w){var v=window.atob(w.split(",")[1]);var z=new ArrayBuffer(v.length);var x=new Uint8Array(z);for(var y=0;y<v.length;y++){x[y]=v.charCodeAt(y)}return new Blob([z],{type:"image/png"})}p.on("paste",function(x){var w=x.clipboardData||x.originalEvent.clipboardData,v;if(w==null){return}if(!q()){return}v=w.items;h.each(v,function(A,B){if(B.type.indexOf("image")>-1){var z=B.getAsFile(),y=new FileReader();y.onload=function(E){var C=E.target.result||this.result,G,F,D;if(r){F=new XMLHttpRequest();D=new FormData();F.open("POST",r,true);F.onload=function(){G=F.responseText;u.command(E,"insertImage",G)};D.append("wangEditorPasteFile",s(C));F.send(D)}else{G=C;u.command(E,"insertImage",G)}};y.readAsDataURL(z)}})})}});i.fn.init.prototype=i.fn;h.extend(i.fn,{initMenus:function(){var r=this,p=r.langConfig.common,q=r.langConfig.menus;r.menus={bold:{title:q.bold.title,type:"btn",hotKey:"ctrl + b",beforeFn:function(s){},cssClass:"wangeditor-menu-img-bold",command:"bold",callback:function(s){}},underline:{title:q.underline.title,type:"btn",hotKey:"ctrl + u",cssClass:"wangeditor-menu-img-underline",command:"underline "},italic:{title:q.italic.title,type:"btn",hotKey:"ctrl + i",cssClass:"wangeditor-menu-img-italic",command:"italic "},removeFormat:{title:q.removeFormat.title,type:"btn",cssClass:"wangeditor-menu-img-eraser",command:"RemoveFormat "},unLink:{title:q.unLink.title,type:"btn",cssClass:"wangeditor-menu-img-unlink",command:"unLink "},insertHr:{title:q.insertHr.title,type:"btn",cssClass:"wangeditor-menu-img-minus",command:"InsertHorizontalRule"},strikethrough:{title:q.strikethrough.title,type:"btn",cssClass:"wangeditor-menu-img-strikethrough",command:"StrikeThrough"},blockquote:{title:q.blockquote.title,type:"btn",cssClass:"wangeditor-menu-img-quotes-left",command:"formatBlock",commandValue:"blockquote",callback:function(u){var t=u.$txt.find("blockquote"),s="hadStyle";h.each(t,function(w,z){var A=h(z),y=A.data(s),v,x;if(y){return}v=A.next();x=A.attr("style")||"";x=i.styleConfig.blockQuoteStyle+x;A.attr("style",x);A.data(s,true);if("length" in v&&v.length===0){A.after("<p><br></p>")}})}},justify:{title:q.justify.title,type:"dropMenu",cssClass:"wangeditor-menu-img-align-left",dropMenu:function(){var s=[],t='<li><a href="#" customCommandName="${command}">${txt}</a></li>',u,v=[{commandName:"JustifyLeft",txt:'<i class="wangeditor-menu-img-align-left"> '+q.justify.left.title+"</i>"},{commandName:"JustifyCenter",txt:'<i class="wangeditor-menu-img-align-center"> '+q.justify.center.title+"</i>"},{commandName:"JustifyRight",txt:'<i class="wangeditor-menu-img-align-right"> '+q.justify.right.title+"</i>"}];h.each(v,function(w,x){s.push(t.replace("${command}",x.commandName).replace("${txt}",x.txt))});u=h(i.htmlTemplates.dropMenu.replace("{content}",s.join("")));return u}},list:{title:q.list.title,type:"dropMenu",cssClass:"wangeditor-menu-img-list-bullet",dropMenu:function(){var s=[],t='<li><a href="#" customCommandName="${command}">${txt}</a></li>',u,v=[{commandName:"InsertUnorderedList",txt:'<i class="wangeditor-menu-img-list-bullet"> '+q.list.unOrdered.title+"</i>"},{commandName:"InsertOrderedList",txt:'<i class="wangeditor-menu-img-list-numbered"> '+q.list.ordered.title+"</i>"}];h.each(v,function(w,x){s.push(t.replace("${command}",x.commandName).replace("${txt}",x.txt))});u=h(i.htmlTemplates.dropMenu.replace("{content}",s.join("")));return u}},fontFamily:{title:q.fontFamily.title,type:"dropMenu",cssClass:"wangeditor-menu-img-font2",command:"fontName ",dropMenu:function(){var s=[],t='<li><a href="#" commandValue="${value}" style="font-family:${family};">${txt}</a></li>',u;h.each(i.styleConfig.fontFamilyOptions,function(v,w){s.push(t.replace("${value}",w).replace("${family}",w).replace("${txt}",w))});u=h(i.htmlTemplates.dropMenu.replace("{content}",s.join("")));return u},callback:function(s){}},fontSize:{title:q.fontSize.title,type:"dropMenu",cssClass:"wangeditor-menu-img-text-height",command:"fontSize",dropMenu:function(){var s=[],t='<li><a href="#" commandValue="${value}" style="font-size:${fontsize};">${txt}</a></li>',u;h.each(i.styleConfig.fontsizeOptions,function(v,w){s.push(t.replace("${value}",v).replace("${fontsize}",w).replace("${txt}",w))});u=h(i.htmlTemplates.dropMenu.replace("{content}",s.join("")));return u}},setHead:{title:q.setHead.title,type:"dropMenu",cssClass:"wangeditor-menu-img-header",command:"formatBlock ",dropMenu:function(){var s=q.setHead.title,u=q.setHead.content;var t='<li><a href="#" commandValue="<h1>"><h1>'+s+'1</h1></a></li><li><a href="#" commandValue="<h2>"><h2>'+s+'2</h2></a></li><li><a href="#" commandValue="<h3>"><h3>'+s+'3</h3></a></li><li><a href="#" commandValue="<h4>"><h4>'+s+'4</h4></a></li><li><a href="#" commandValue="<p>">'+u+"</a></li>";return h(i.htmlTemplates.dropMenu.replace("{content}",t))}},foreColor:{title:q.foreColor.title,type:"dropPanel",cssClass:"wangeditor-menu-img-pencil",command:"foreColor",dropPanel:function(){var s=[],t='<a href="#" commandValue="${value}" style="background-color:${color};" title="${txt}" class="forColorItem">&nbsp;</a>',u;h.each(i.styleConfig.colorOptions,function(v,x){var w=t.replace("${value}",v).replace("${color}",v).replace("${txt}",x);s.push(i.htmlTemplates.dropPanel_floatItem.replace("{content}",w))});u=h(i.htmlTemplates.dropPanel.replace("{content}",s.join("")));return u}},backgroundColor:{title:q.backgroundColor.title,type:"dropPanel",cssClass:"wangeditor-menu-img-brush",command:"backColor ",dropPanel:function(){var s=[],t='<a href="#" commandValue="${value}" style="background-color:${color};" title="${txt}" class="forColorItem">&nbsp;</a>',u;h.each(i.styleConfig.colorOptions,function(v,x){var w=t.replace("${value}",v).replace("${color}",v).replace("${txt}",x);s.push(i.htmlTemplates.dropPanel_floatItem.replace("{content}",w))});u=h(i.htmlTemplates.dropPanel.replace("{content}",s.join("")));return u}},createLink:{title:q.createLink.title,type:"modal",cssClass:"wangeditor-menu-img-link",modal:function(x){var C=i.getUniqeId(),B=i.getUniqeId(),E=i.getUniqeId(),w=i.getUniqeId();var v=q.createLink.modal,u=v.link,s=v.title,A=v.blank,D=p.insert,t=p.unsafeAlert;var y="<p>"+u+'：<input id="'+C+'" type="text" style="width:300px;"  placeholder="http://"/></p><p>'+s+'：<input id="'+B+'" type="text" style="width:300px;"/></p><p>'+A+'：<input id="'+E+'" type="checkbox" checked="checked"/></p><p><button id="'+w+'" type="button" class="wangEditor-modal-btn">'+D+"</button></p>",z=h(i.htmlTemplates.modalSmall.replace("{content}",y));z.find("#"+w).click(function(J){var G=h.trim(h("#"+C).val()),K=h.trim(h("#"+B).val()),F=h("#"+E).is(":checked"),H=x.hasSelectionContent(),L,I=function(){h("#"+C).val("");h("#"+B).val("")};if(G!==""){if(i.filterXSSForUrl(G)===false){alert(t);return}if(H===false){if(K===""){K=G}L='<a href="'+G+'" target="_blank">'+K+"</a>";x.command(J,"insertHTML",L,I)}else{if(K===""&&!F){x.command(J,"createLink",G,I)}else{x.command(J,"customCreateLink",{url:G,title:K,isBlank:F},I)}}}});return z}},insertExpression:{title:q.insertExpression.title,type:"dropPanel",command:"insertImage",cssClass:"wangeditor-menu-img-happy",dropPanel:function(x){var J=i.expressionConfig,C=J.path,w=J.fileNames,s=w[0],B=w[1],z=J.ext,y=[],D=1;if(C.indexOf("wangeditor.github.io")>0){i.consoleLog("目前的表情图片要访问github.com，速度很慢（可能失败），强烈建议自行配置表情图标！")}if(x.expressions){y=x.expressions}else{for(;D<=B;D++){y.push(C+D+z)}}var v,G='<a href="#" commandValue="${value}">   <img r_src="${src}" expression="1"/></a>',t=[],F=0,u=[],E,I=[],A,H=this.cssClass;if(typeof y[0]==="string"){h.each(y,function(K,M){var L=G.replace("${value}",M).replace("${src}",M);t.push(i.htmlTemplates.dropPanel_floatItem.replace("{content}",L))});v=h(i.htmlTemplates.dropPanelBig.replace("{content}",t.join("")))}else{h.each(y,function(L,O){F=F+1;var Q=O.title,M,N=O.items,K=[],P;M=i.htmlTemplates.dropPanel_expression_tab.replace("{content}",Q).replace("{index}",F);u.push(M);h.each(N,function(R,T){var S=G.replace("${value}",T).replace("${src}",T);K.push(i.htmlTemplates.dropPanel_floatItem.replace("{content}",S))});P=i.htmlTemplates.dropPanel_expression_group.replace("{content}",K.join("")).replace("{index}",F);I.push(P)});E=i.htmlTemplates.dropPanel_expression_tab_container.replace("{content}",u.join(""));A=i.htmlTemplates.dropPanel_expression_group_container.replace("{content}",I.join(""));v=h(i.htmlTemplates.dropPanelBig.replace("{content}",E+A));h(function(){var L=h(".wangEditor-expression-tab-container"),K=L.children(),O=h(".wangEditor-expression-group-container"),M=O.children();function N(Q){var P=Q.attr("index");K.removeClass("selected");Q.addClass("selected");M.hide();O.find("[index="+P+"]").show()}N(K.first());K.click(function(P){N(h(this));P.stopPropagation()})})}h(function(){var K=h("."+H).parent();K.on("click.loadImg",function(){v.find("img[r_src]").each(function(){var L=h(this);var M=L.attr("r_src");L.attr("src",M);L.removeAttr("r_src")});K.off("click.loadImg")})});return v}},insertVideo:{title:q.insertVideo.title,type:"modal",cssClass:"wangeditor-menu-img-play",modal:function(B){var D=i.getUniqeId(),F=i.getUniqeId(),z=i.getUniqeId(),x=i.getUniqeId(),H=480,t=400;var v=q.insertVideo.modal,E=v.url,y=v.width,A=v.height,G=p.insert,u=p.unsafeAlert,s=p.formatError;var C="<p>"+E+'：<input id="'+D+'" type="text" style="width:300px;"  placeholder="*.swf, *.mp4, *.ogg, *.webm"/></p><p>'+y+'：<input id="'+F+'" type="text" style="width:50px" value="'+H+'"/> px（像素）</p><p>'+A+'：<input id="'+z+'" type="text" style="width:50px" value="'+t+'"/> px（像素） </p><p><button id="'+x+'" class="wangEditor-modal-btn" type="button">'+G+"</button></p>";var w=h(i.htmlTemplates.modalSmall.replace("{content}",C));w.find("#"+x).click(function(N){var O=h.trim(h("#"+D).val()),L=+(h("#"+F).val()),I=+(h("#"+z).val()),K=/^\s*(http:\/\/|https:\/\/).+(\.swf|\.ogg|\.mp4|\.webm)\s*$/i,J,M=function(){h("#"+D).val("");h("#"+F).val(H);h("#"+z).val(t)};if(i.filterXSSForUrl(O)===false){alert(u);return}if(!K.test(O)){alert(s);return}if(isNaN(L)){L=H}if(isNaN(I)){I=t}if((/.swf\s*$/i).test(O)===true){J=i.htmlTemplates.videoEmbed.replace(/#{vedioUrl}/ig,O).replace(/#{width}/ig,L).replace(/#{height}/ig,I)}else{J=i.htmlTemplates.videoH5.replace(/#{vedioUrl}/ig,O).replace(/#{width}/ig,L).replace(/#{height}/ig,I)}B.command(N,"insertHTML",J,M)});return w}},insertTable:{title:q.insertTable.title,type:"modal",cssClass:"wangeditor-menu-img-table",modal:function(A){var s=i.getUniqeId(),v=i.getUniqeId(),z=i.getUniqeId(),x=i.getUniqeId();var u=q.insertTable.modal,y=u.rowNum,C=u.colNum,w=u.showFirstRow,D=p.insert;var B="<p>"+y+'：<input id="'+s+'" type="text" value="3"/></p><p>'+C+'：<input id="'+v+'" type="text" value="5"/></p><p>'+w+'：<input id="'+z+'" type="checkbox" checked="checked"/></p><p><button id="'+x+'"  type="button" class="wangEditor-modal-btn">'+D+"</button></p>",t=h(i.htmlTemplates.modalSmall.replace("{content}",B));t.find("#"+x).click(function(L){var R=h("#"+s).val(),Q=R===""||isNaN(+R)?3:R,U=h("#"+v).val(),F=U===""||isNaN(+U)?5:U,O=h("#"+z).is(":checked"),N=function(){h("#"+s).val("");h("#"+v).val("")},K,J,T="",M='<div style="max-width:100%;overflow-x:auto;"><table border="1" bordercolor="#cccccc" cellpadding="0" cellspacing="0" style="border-collapse:collapse;" > ${content} </table></div>',I=[],H='<tr style="font-weight:bold;background-color:#f1f1f1;">${content}</tr>',S="<tr>${content}</tr>",E,P='<td style="min-width:100px; padding:5px;">&nbsp;</td>',G='<td style="padding:5px;">&nbsp;</td>';for(K=0;K<Q;K++){E=[];for(J=0;J<F;J++){if(K===0){E.push(P)}else{E.push(G)}}if(K===0&&O){I.push(H.replace("${content}",E.join("")))}else{I.push(S.replace("${content}",E.join("")))}}T=M.replace("${content}",I.join(""));A.command(L,"insertHTML",T,N)});return t}},insertImage:{title:q.insertImage.title,type:"modal",cssClass:"wangeditor-menu-img-picture",modal:function(y){var B=y.uploadImgComponent,u=i.getUniqeId(),A=i.getUniqeId(),s=i.getUniqeId(),F=i.getUniqeId(),E=i.getUniqeId(),x=i.getUniqeId();var w=q.insertImage.modal,D=w.insertWeb,H=w.insertLocal,G=w.url,t=w.title,I=p.insert,v=p.unsafeAlert;var z='<p>   <span id="'+A+'">'+D+'</span>    <a href="#" id="'+s+'"></a></p><div id="'+u+'">   <p>'+G+'：<input id="'+F+'" type="text" style="width:300px;" placeholder="http://"/></p>   <p>'+t+'：<input id="'+E+'" type="text" style="width:300px;"/></p><p><button id="'+x+'" type="button" class="wangEditor-modal-btn">'+I+"</button></p></div>",C=h(i.htmlTemplates.modalSmall.replace("{content}",z));h(function(){var K=h("#"+u),L=h("#"+A),N=h("#"+s);function M(){B.show();K.hide();L.text(H);N.text(D)}function J(){B.hide();K.show();L.text(D);N.text(H)}if(B){C.append(B);M()}N.click(function(P){var O=N.text();if(O===H){M()}else{J()}P.preventDefault()})});C.find("#"+x).click(function(K){var J=h.trim(h("#"+F).val()),M=h.trim(h("#"+E).val()),L=function(){h("#"+F).val("");h("#"+E).val("")};if(!J){J=h.trim(m.getElementById(F).value);M=h.trim(m.getElementById(E).value)}if(J!==""){if(i.filterXSSForUrl(J)===false){alert(v);return}if(M===""){y.command(K,"insertImage",J,L)}else{y.command(K,"customeInsertImage",{url:J,title:M},L)}}});return C}},insertCode:{title:q.insertCode.title,type:"modal",cssClass:"wangeditor-menu-img-terminal",modal:function(A){var s=i.getUniqeId(),u=i.getUniqeId(),y=i.getUniqeId();var v=q.insertCode.modal,t=v.title;var C="<p>"+t+'：{selectLangs}</p><div><textarea id="'+s+'" style="width:100%; height:100px;"></textarea></div><button id="'+y+'"  type="button" class="wangEditor-modal-btn">插入</button>',B='<select id="'+u+'">{content}</select>',x;var D=false,z=window.hljs,F=z&&z.listLanguages,w=typeof F==="function"&&F(),E="";if(w&&typeof w==="object"&&w.length){h.each(w,function(G,H){E=E+'<option value="'+H+'">'+H+"</option>"});B=B.replace("{content}",E);C=C.replace("{selectLangs}",B);D=true}else{C=C.replace("{selectLangs}","")}x=h(i.htmlTemplates.modal.replace("{content}",C));x.find("#"+y).click(function(H){var G=h.trim(h("#"+s).val()),J=function(){h("#"+s).val("");if(D){h("pre code").each(function(K,L){z.highlightBlock(L)})}};var I;if(D){I=h("#"+u).val()}if(G&&G!==""){G=G.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;");if(D){G=i.htmlTemplates.codePreWidthHightLight.replace("{lang}",I).replace("{content}",G)}else{G=i.htmlTemplates.codePre.replace("{content}",G)}A.command(H,"insertHTML",G,J)}});return x}},insertLocation:{title:q.insertLocation.title,type:"modal",cssClass:"wangeditor-menu-img-location",modal:function(v){var B=i.getUniqeId(),E=i.getUniqeId(),L=i.getUniqeId(),x=i.getUniqeId(),H=i.getUniqeId(),z=i.getUniqeId(),t=i.getUniqeId();var O=q.insertLocation.modal,F=O.city,K=O.location,P=O.search,I=O.clear,C=O.loading,s=O.dynamic,D=p.insert,w=q.insertLocation.alert,y=w.cantFindLocation,u=w.dynamicOneLocation;var G=F+'：<input type="text" id="'+B+'" style="width:60px;"/> '+K+'：<input type="text" id="'+E+'"> <button class="wangEditor-modal-btn" id="'+L+'"  type="button">'+P+'</button> <button class="wangEditor-modal-btn" id="'+x+'"  type="button">'+I+'</button> <div id="'+H+'" style="width:100%; height:220px; border:1px solid #ccc; margin:10px 0px;">'+C+'</div> <button class="wangEditor-modal-btn" id="'+z+'"  type="button">'+D+'</button> <input type="checkbox" id="'+t+'"/>'+s;var A=h(i.htmlTemplates.modal.replace("{content}",G));var M=this.cssClass;var N,J=[];window.baiduMapCallBack=function(){N=new BMap.Map(H);N.centerAndZoom(new BMap.Point(116.404,39.915),11);N.addControl(new BMap.MapTypeControl());N.setCurrentCity("北京");N.enableScrollWheelZoom(true);function Q(S){var T=S.name;N.setCenter(T);h("#"+B).val(T)}var R=new BMap.LocalCity();R.get(Q);N.addEventListener("click",function(T){var S=new BMap.Marker(new BMap.Point(T.point.lng,T.point.lat));N.addOverlay(S);S.enableDragging();J.push(S)})};h(function(){var Q=h("."+M).parent();Q.on("click.loadMap",function(){var S="TVhjYjq1ICT2qqL5LdS8mwas";var R=m.createElement("script");R.type="text/javascript";R.src="http://api.map.baidu.com/api?v=2.0&ak="+S+"&callback=baiduMapCallBack";m.body.appendChild(R);Q.off("click.loadMap")})});A.find("#"+L).click(function(T){var R=h.trim(h("#"+B).val()),S=h.trim(h("#"+E).val()),U,Q;if(R!==""){if(!S||S===""){N.centerAndZoom(R,11)}if(S&&S!==""){U=new BMap.Geocoder();U.getPoint(S,function(V){if(V){N.centerAndZoom(V,13);Q=new BMap.Marker(V);N.addOverlay(Q);Q.enableDragging();J.push(Q)}else{alert(y);N.centerAndZoom(R,11)}},R)}}});A.find("#"+x).click(function(Q){N.clearOverlays();J=[]});A.find("#"+z).click(function(Y){var Z=h("#"+t).is(":checked"),S=N.getCenter(),U=S.lng,T=S.lat,aa=N.getZoom(),ab=N.getSize(),R=ab.width,X=ab.height,W,Q,V;if(Z){Q="http://ueditor.baidu.com/ueditor/dialogs/map/show.html#"}else{Q="http://api.map.baidu.com/staticimage?"}Q=Q+"center="+U+","+T+"&zoom="+aa+"&width="+R+"&height="+X;if(J.length>0){Q=Q+"&markers=";h.each(J,function(ac,ad){W=ad.getPosition();if(ac>0){Q=Q+"|"}Q=Q+W.lng+","+W.lat})}if(Z){if(J.length>1){alert(u);return}Q+="&markerStyles=l,A";V='<iframe class="ueditor_baidumap" src="{src}" frameborder="0" width="'+R+'" height="'+X+'"></iframe>';V=V.replace("{src}",Q);v.command(Y,"insertHTML",V)}else{v.command(Y,"insertImage",Q)}});return A}},undo:{title:q.undo.title,type:"btn",hotKey:"ctrl+z",cssClass:"wangeditor-menu-img-ccw",command:"commonUndo",callback:function(s){s.blur()}},redo:{title:q.redo.title,type:"btn",cssClass:"wangeditor-menu-img-cw",command:"commonRedo",callback:function(s){s.blur()}},viewSourceCode:{title:q.viewSourceCode.title,type:"modal",cssClass:"wangeditor-menu-img-code",modal:function(u){var t=i.getUniqeId(),y=i.getUniqeId();var s=p.update;var v='<div><textarea style="width:100%; height:200px;" id="'+t+'"></textarea></div><button id="'+y+'" class="wangEditor-modal-btn"  type="button">'+s+"</button>";var w=h(i.htmlTemplates.modalBig.replace("{content}",v));var x=this.cssClass;h(function(){u.$btnContainer.find("."+x).parent().click(function(A){var z=u.html();z=i.replaceQuotes(z);h("#"+t).val(z)})});w.find("#"+y).click(function(A){var z=h("#"+t).val();if(u.filterJs){z=z.replace(/<script[\s\S]*?<\/script>/ig,"")}if(h.trim(z)===""){z="<p><br></p>"}u.command(A,"replaceSourceCode",z)});return w}},fullScreen:{title:q.fullScreen.title,type:"btn",cssClass:"wangeditor-menu-img-enlarge2",command:"fullScreen"},mobilePreView:{title:q.mobilePreView.title,type:"modal",cssClass:"wangeditor-menu-img-tablet",modal:function(t){var w=i.getUniqeId();var u=['<center><div class="mobile-prev-container">','   <div class="prev-tip-top"></div>','   <div class="prev-content" id="'+w+'"></div>','   <div class="prev-tip-bottom"></div>',"</div></center>"].join("");var s=h(i.htmlTemplates.modalSmall.replace("{content}",u));var v=this.cssClass;h(function(){var x=h("#"+w);t.$btnContainer.find("."+v).parent().click(function(){x.html(t.html())})});return s}}}}});h.extend(i.fn,{initMenuConfig:function(){this.editorMenuConfig=[["viewSourceCode"],["bold","underline","italic","foreColor","backgroundColor","strikethrough","removeFormat"],["blockquote","fontFamily","fontSize","setHead","list","justify"],["createLink","unLink","insertTable"],["insertImage","insertVideo","insertLocation","insertCode"],["mobilePreView","undo","redo","fullScreen"]]}});h.extend(i.fn,{getCommandBtns:function(){if(this.$btnsWithCommandName==null){this.$btnsWithCommandName=this.$btnContainer.find("a[commandName]")}return this.$btnsWithCommandName},updateMenuStyle:function(){var p=this.getCommandBtns();if(p.length<=0){return}p.each(function(){var r=h(this),q=h.trim(r.attr("commandName")).toLowerCase();if(q==="insertunorderedlist"||q==="insertorderedlist"){return}if(i.commandEnabled(q)&&m.queryCommandState(q)){r.addClass("wangEditor-btn-container-btn-selected")}else{r.removeClass("wangEditor-btn-container-btn-selected")}})}});h.extend(i.fn,{parentElemForCurrentRange:function(p){if(p){this.parentElem=p}else{return this.parentElem}},currentRange:function(p){if(p){this.currentRangeData=p}else{return this.currentRangeData}},saveSelection:function(q){var s=this,r,t,p=s.$txt[0];if(k){if(q){t=q.commonAncestorContainer}else{r=m.getSelection();if(r.getRangeAt&&r.rangeCount){q=m.getSelection().getRangeAt(0);t=q.commonAncestorContainer}}}else{q=m.selection.createRange();if(typeof q.parentElement==="undefined"){t=null}else{t=q.parentElement()}}if(t&&(h.contains(p,t)||p===t)){s.parentElemForCurrentRange(t);s.currentRange(q)}},restoreSelection:function(){var t=this,p=t.currentRange(),s,q;if(!p){return}if(k){s=m.getSelection();s.removeAllRanges();s.addRange(p)}else{q=m.selection.createRange();try{q.setEndPoint("EndToEnd",p)}catch(r){}if(p.text.length===0){q.collapse(false)}else{q.setEndPoint("StartToStart",p)}q.select()}},initSelection:function(){var r=this,q,p=r.$txt.get(0);if(r.currentRange()){return}if(k){q=m.createRange();q.setStart(p,0);q.setEnd(p,0)}if(q){r.saveSelection(q)}},hasSelectionContent:function(){var q=this,p=this.currentRange();if(k){if(p.endContainer===p.startContainer&&p.endOffset===p.startOffset){return false}}return true}});h.extend(i.fn,{change:function(){var q=this,p=q.html();if(p.length!==q.latestHtml.length||p!==q.latestHtml){p=i.replaceQuotes(p);i.showTableBorder(this.$txt);i.addImgMaxWidth(this.$txt);q.textareaVal(p);if(q.onchange){q.onchange(p)}q.latestHtml=p}}});h.extend(i.fn,{_initCommandRecord:function(){var q=this,p=q.html();q.commandRecords=[];q.commandRecords.push(p);q.commandRecordCursor=0},addCommandRecord:function(){var q=this,r=q.commandRecords.length,p=q.html();if(r>0){if(p===q.commandRecords[q.commandRecordCursor]){return}}q.commandRecords.push(p);if(r>=j){q.commandRecords.shift()}r=q.commandRecords.length;q.commandRecordCursor=r-1},undo:function(){if(this.commandRecordCursor>0){this.commandRecordCursor=this.commandRecordCursor-1;this.html(this.commandRecords[this.commandRecordCursor])}},redo:function(){var p=this,q=p.commandRecords.length;if(p.commandRecordCursor<q-1){p.commandRecordCursor=p.commandRecordCursor+1;p.html(p.commandRecords[p.commandRecordCursor])}}});h.extend(i.fn,{commandHooks:{insertHTML:function(t,r){var s,q=this.currentRange(),p=this.parentElemForCurrentRange();if(!q){return}s=i.getElemForInsertTable(h(p));if(s.next().length===0){r+="<p><br/></p>"}s.after(h(r))},customCreateLink:function(t,q){var s=q.url,v=q.title,p=q.isBlank,w=i.getUniqeId(),u,r;u=this.$txt.find("a");if(u.length>0){u.attr(w,"1")}m.execCommand("createLink",false,s);r=this.$txt.find("a").not("["+w+"]");if(v){r.attr("title",v)}if(p){r.attr("target","_blank")}if(u.length>0){u.removeAttr(w)}},customeInsertImage:function(s,q){var r=q.url,v=q.title,t=q.link,w=i.getUniqeId(),p,u;p=this.$txt.find("img");if(p.length>0){p.attr(w,"1")}m.execCommand("insertImage",false,r);u=this.$txt.find("img").not("["+w+"]");u.attr("title",v);u.attr("alt",v);if(t&&typeof t==="string"){u.wrap('<a href="'+t+'" target="_blank"></a>')}if(p.length>0){p.removeAttr(w)}},"delete$elem":function(q,p){p.remove()},commonUndo:function(q,p){this.undo(q,p)},commonRedo:function(q,p){this.redo(q,p)},replaceSourceCode:function(q,p){this.html(p)},fullScreen:function(r,y){var p=this.$txtContainer,v=this.getEditorContainer(),s=v.css("position"),w=p.css("max-height"),q="wangeditor-menu-img-enlarge2",u="wangeditor-menu-img-shrink2",t=v.find("."+q),x=v.find("."+u);if(t.length){t.removeClass(q).addClass(u)}else{if(x.length){x.removeClass(u).addClass(q)}}if(s!=="fixed"){this._txtContainerHeight=p.height();p.css({height:"90%"});v.css({position:"fixed",top:25,left:20,right:20,bottom:20,"z-index":1000,"-webkit-box-shadow":"0 0 30px #999","-moz-box-shadow":"0 0 30px #999","box-shadow":"0 0 30px #999"});p.css("max-height","none")}else{p.height(this._txtContainerHeight);v.css({position:"relative",top:0,left:0,right:0,bottom:0,"z-index":0,"-webkit-box-shadow":"0 0 0 #CCC","-moz-box-shadow":"0 0 0 #CCC","box-shadow":"0 0 0 #CCC"});p.css("max-height",w)}}}});h.extend(i.fn,{command:function(s,q,p,t){if(!this.currentRange()){alert("未选中编辑区，无法执行操作")}else{var r;this.restoreSelection();if(i.commandEnabled(q)===true){m.execCommand(q,false,p)}else{r=this.commandHooks[q];if(r){r.call(this,q,p)}else{i.consoleLog("不支持“"+q+"”命令，请检查。")}}this.saveSelection();if(t&&typeof t==="function"){t(this)}this.updateMenuStyle();this.addCommandRecord();this.change()}this.hideModal();if(s){s.preventDefault()}}});if(!Array.prototype.indexOf){Array.prototype.indexOf=function(r){var p=0,q=this.length;for(;p<q;p++){if(this[p]===r){return p}}return -1};Array.prototype.lastIndexOf=function(q){var p=this.length;for(p=p-1;p>=0;p--){if(this[p]===q){return p}}return -1}}if(!Date.now){Date.now=function(){return new Date().valueOf()}}h.fn.extend({wangEditor:function(p){if(this[0].nodeName!=="TEXTAREA"){alert("wangEditor提示：请使用textarea扩展富文本框。");return}if(this.data("wangEditorFlag")){alert("针对一个textarea不能执行两遍wangEditor()事件");return}else{this.data("wangEditorFlag",true)}p=p||{};var q=i(this,p);this.before(q.$editorContainer);this.hide();q.initSelection();return q}})});